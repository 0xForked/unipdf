//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_d "errors";_c "fmt";_ad "github.com/unidoc/unipdf/v3/common";_a "github.com/unidoc/unipdf/v3/core";);func (_aa *Catalog )GetMarkInfo ()(*_a .PdfObjectDictionary ,bool ){_da ,_g :=_a .GetDict (_aa .Object .Get ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f"));
return _da ,_g ;};func (_ce *Document )FindCatalog ()(*Catalog ,bool ){var _bfc *_a .PdfObjectDictionary ;for _ ,_ge :=range _ce .Objects {_ffa ,_cge :=_a .GetDict (_ge );if !_cge {continue ;};if _ece ,_cf :=_a .GetName (_ffa .Get ("\u0054\u0079\u0070\u0065"));
_cf &&*_ece =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_bfc =_ffa ;break ;};};if _bfc ==nil {return nil ,false ;};return &Catalog {Object :_bfc ,_db :_ce },true ;};func (_deb *Catalog )SetMarkInfo (mi _a .PdfObject ){_cgd :=_a .MakeIndirectObject (mi );
_deb .Object .Set ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f",_cgd );_deb ._db .Objects =append (_deb ._db .Objects ,_cgd );};func (_gaf Page )GetResourcesXObject ()(*_a .PdfObjectDictionary ,bool ){_fbd ,_adff :=_gaf .GetResources ();if !_adff {return nil ,false ;
};return _a .GetDict (_fbd .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};func (_ace *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _bff :=_ace .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
_bff !=nil {for _dgf ,_f :=range _ace ._db .Objects {if _f ==_bff {if outputIntents ._gb ==_bff {return ;};_ace ._db .Objects =append (_ace ._db .Objects [:_dgf ],_ace ._db .Objects [_dgf +1:]...);break ;};};};_fa :=outputIntents ._gb ;if _fa ==nil {_fa =_a .MakeIndirectObject (outputIntents ._ff );
};_ace .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_fa );_ace ._db .Objects =append (_ace ._db .Objects ,_fa );};func (_cac *OutputIntents )Len ()int {return _cac ._ff .Len ()};func (_af *Catalog )HasMetadata ()bool {_egg :=_af .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");
return _egg !=nil ;};func (_gg *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_dd :_gg ._db }};type Image struct{Name string ;Width int ;Height int ;Colorspace _a .PdfObjectName ;ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;
Stream *_a .PdfObjectStream ;};func (_acd Page )GetContents ()([]Content ,bool ){_bffg ,_fdb :=_a .GetArray (_acd .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_fdb {_gab ,_bcbf :=_a .GetStream (_acd .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_bcbf {return nil ,false ;};return []Content {{Stream :_gab ,_aca :_acd ,_ggc :0}},true ;};_egee :=make ([]Content ,_bffg .Len ());for _fe ,_debg :=range _bffg .Elements (){_fdg ,_df :=_a .GetStream (_debg );if !_df {continue ;};_egee [_fe ]=Content {Stream :_fdg ,_aca :_acd ,_ggc :_fe };
};return _egee ,true ;};func (_ec *Catalog )GetPages ()([]Page ,bool ){_b ,_ed :=_a .GetDict (_ec .Object .Get ("\u0050\u0061\u0067e\u0073"));if !_ed {return nil ,false ;};_cc ,_dbd :=_a .GetArray (_b .Get ("\u004b\u0069\u0064\u0073"));if !_dbd {return nil ,false ;
};_eg :=make ([]Page ,_cc .Len ());for _bd ,_dg :=range _cc .Elements (){_cb ,_bf :=_a .GetDict (_dg );if !_bf {continue ;};_eg [_bd ]=Page {Object :_cb ,_bcb :_bd +1,_gfg :_ec ._db };};return _eg ,true ;};type Catalog struct{Object *_a .PdfObjectDictionary ;
_db *Document ;};type Page struct{_bcb int ;Object *_a .PdfObjectDictionary ;_gfg *Document ;};func (_de *Catalog )SetVersion (){_de .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_a .MakeName (_c .Sprintf ("\u0025\u0064\u002e%\u0064",_de ._db .Version .Major ,_de ._db .Version .Minor )));
};func (_dc *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_cd :=_dc .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");if _cd ==nil {return nil ,false ;};_ag ,_cbe :=_a .GetIndirect (_cd );if !_cbe {return nil ,false ;
};_gge ,_dcb :=_a .GetArray (_ag .PdfObject );if !_dcb {return nil ,false ;};return &OutputIntents {_gb :_ag ,_ff :_gge ,_dd :_dc ._db },true ;};type ImageSMask struct{Image *Image ;Stream *_a .PdfObjectStream ;};func (_adf *Document )GetPages ()([]Page ,bool ){_bba ,_ebe :=_adf .FindCatalog ();
if !_ebe {return nil ,false ;};return _bba .GetPages ();};func (_bc *Document )AddStream (stream *_a .PdfObjectStream ){for _ ,_dbb :=range _bc .Objects {if _dbb ==stream {return ;};};_bc .Objects =append (_bc .Objects ,stream );};func _ecec (_fc _a .PdfObject )(_a .PdfObjectName ,error ){var _ecg *_a .PdfObjectName ;
var _bg *_a .PdfObjectArray ;if _ba ,_dcbc :=_fc .(*_a .PdfIndirectObject );_dcbc {if _faf ,_fce :=_ba .PdfObject .(*_a .PdfObjectArray );_fce {_bg =_faf ;}else if _eecg ,_bef :=_ba .PdfObject .(*_a .PdfObjectName );_bef {_ecg =_eecg ;};}else if _dga ,_ga :=_fc .(*_a .PdfObjectArray );
_ga {_bg =_dga ;}else if _fb ,_cbg :=_fc .(*_a .PdfObjectName );_cbg {_ecg =_fb ;};if _ecg !=nil {switch *_ecg {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_ecg ,nil ;
case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_ecg ,nil ;};};if _bg !=nil &&_bg .Len ()> 0{if _ebf ,_fcf :=_bg .Get (0).(*_a .PdfObjectName );_fcf {switch *_ebf {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _bg .Len ()==1{return *_ebf ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_ebf ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_ebf ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_ebf ,nil ;};};};return "",nil ;};func (_ee *Catalog )SetMetadata (data []byte )error {_ca ,_ac :=_a .MakeStream (data ,nil );if _ac !=nil {return _ac ;
};_ca .Set ("\u0054\u0079\u0070\u0065",_a .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));_ca .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_a .MakeName ("\u0058\u004d\u004c"));_ee .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_ca );
_ee ._db .Objects =append (_ee ._db .Objects ,_ca );return nil ;};func (_beeg Content )GetData ()([]byte ,error ){_bcc ,_bae :=_a .NewEncoderFromStream (_beeg .Stream );if _bae !=nil {return nil ,_bae ;};_bac ,_bae :=_bcc .DecodeStream (_beeg .Stream );
if _bae !=nil {return nil ,_bae ;};return _bac ,nil ;};func (_aab Page )GetResources ()(*_a .PdfObjectDictionary ,bool ){return _a .GetDict (_aab .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));};func (_bbg *Content )SetData (data []byte )error {_ggea ,_egb :=_a .MakeStream (data ,_a .NewFlateEncoder ());
if _egb !=nil {return _egb ;};_edfc ,_cgb :=_a .GetArray (_bbg ._aca .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_cgb &&_bbg ._ggc ==0{_bbg ._aca .Object .Set ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073",_ggea );}else {if _egb =_edfc .Set (_bbg ._ggc ,_ggea );
_egb !=nil {return _egb ;};};_bbg ._aca ._gfg .Objects =append (_bbg ._aca ._gfg .Objects ,_ggea );return nil ;};func (_eb *Catalog )GetMetadata ()(*_a .PdfObjectStream ,bool ){_cg ,_ea :=_a .GetStream (_eb .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));
return _cg ,_ea ;};type OutputIntents struct{_ff *_a .PdfObjectArray ;_dd *Document ;_gb *_a .PdfIndirectObject ;};type Document struct{ID [2]string ;Version _a .Version ;Objects []_a .PdfObject ;Info _a .PdfObject ;Crypt *_a .PdfCrypt ;UseHashBasedID bool ;
};func (_ggd *OutputIntents )Get (i int )(OutputIntent ,bool ){if _ggd ._ff ==nil {return OutputIntent {},false ;};if i >=_ggd ._ff .Len (){return OutputIntent {},false ;};_bb :=_ggd ._ff .Get (i );_bda ,_fab :=_a .GetIndirect (_bb );if !_fab {_cbf ,_bea :=_a .GetDict (_bb );
return OutputIntent {Object :_cbf },_bea ;};_eec ,_afa :=_a .GetDict (_bda .PdfObject );return OutputIntent {Object :_eec },_afa ;};func (_bcf *Document )AddIndirectObject (indirect *_a .PdfIndirectObject ){for _ ,_ab :=range _bcf .Objects {if _ab ==indirect {return ;
};};_bcf .Objects =append (_bcf .Objects ,indirect );};func (_fefc Page )FindXObjectForms ()[]*_a .PdfObjectStream {_def ,_fea :=_fefc .GetResourcesXObject ();if !_fea {return nil ;};_cdd :=map[*_a .PdfObjectStream ]struct{}{};var _afb func (_gad *_a .PdfObjectDictionary ,_bcbg map[*_a .PdfObjectStream ]struct{});
_afb =func (_ggfe *_a .PdfObjectDictionary ,_edf map[*_a .PdfObjectStream ]struct{}){for _ ,_fdbg :=range _ggfe .Keys (){_gbc ,_dff :=_a .GetStream (_ggfe .Get (_fdbg ));if !_dff {continue ;};if _ ,_dgeg :=_edf [_gbc ];_dgeg {continue ;};_agc ,_gdc :=_a .GetName (_gbc .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));
if !_gdc ||_agc .String ()!="\u0046\u006f\u0072\u006d"{continue ;};_edf [_gbc ]=struct{}{};_eggb ,_gdc :=_a .GetDict (_gbc .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));if !_gdc {continue ;};_aaa ,_geg :=_a .GetDict (_eggb .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));
if _geg {_afb (_aaa ,_edf );};};};_afb (_def ,_cdd );var _gged []*_a .PdfObjectStream ;for _bbf :=range _cdd {_gged =append (_gged ,_bbf );};return _gged ;};func (_fcfd *Page )Number ()int {return _fcfd ._bcb };type Content struct{Stream *_a .PdfObjectStream ;
_ggc int ;_aca Page ;};func (_be *OutputIntents )Add (oi _a .PdfObject )error {_ef ,_gf :=oi .(*_a .PdfObjectDictionary );if !_gf {return _d .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _fd ,_cae :=_a .GetStream (_ef .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_cae {_be ._dd .Objects =append (_be ._dd .Objects ,_fd );};_ae ,_ege :=oi .(*_a .PdfIndirectObject );if !_ege {_ae =_a .MakeIndirectObject (oi );
};if _be ._ff ==nil {_be ._ff =_a .MakeArray (_ae );}else {_be ._ff .Append (_ae );};_be ._dd .Objects =append (_be ._dd .Objects ,_ae );return nil ;};func (_bgc Page )FindXObjectImages ()([]*Image ,error ){_ccd ,_gde :=_bgc .GetResourcesXObject ();if !_gde {return nil ,nil ;
};var _fbb []*Image ;var _eab error ;_cfa :=map[*_a .PdfObjectStream ]int {};_deba :=map[*_a .PdfObjectStream ]struct{}{};var _cbga int ;for _ ,_bffc :=range _ccd .Keys (){_gbe ,_cbd :=_a .GetStream (_ccd .Get (_bffc ));if !_cbd {continue ;};if _ ,_bed :=_cfa [_gbe ];
_bed {continue ;};_gag ,_cga :=_a .GetName (_gbe .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_cga ||_gag .String ()!="\u0049\u006d\u0061g\u0065"{continue ;};_cag :=Image {BitsPerComponent :8,Stream :_gbe ,Name :string (_bffc )};if _cag .Colorspace ,_eab =_ecec (_gbe .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));
_eab !=nil {_ad .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_eab );continue ;};if _bee ,_gbbc :=_a .GetIntVal (_gbe .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));
_gbbc {_cag .BitsPerComponent =_bee ;};if _cgf ,_abf :=_a .GetIntVal (_gbe .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));_abf {_cag .Width =_cgf ;};if _eac ,_ggf :=_a .GetIntVal (_gbe .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));
_ggf {_cag .Height =_eac ;};if _aef ,_fae :=_a .GetStream (_gbe .Get ("\u0053\u004d\u0061s\u006b"));_fae {_cag .SMask =&ImageSMask {Image :&_cag ,Stream :_aef };_deba [_aef ]=struct{}{};};switch _cag .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_cag .ColorComponents =3;
case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_cag .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_cag .ColorComponents =4;default:_cag .ColorComponents =-1;};_cfa [_gbe ]=_cbga ;_fbb =append (_fbb ,&_cag );
_cbga ++;};var _adc []int ;for _ ,_eca :=range _fbb {if _eca .SMask !=nil {_beaf ,_bffcc :=_cfa [_eca .SMask .Stream ];if _bffcc {_adc =append (_adc ,_beaf );};};};_bgd :=make ([]*Image ,len (_fbb )-len (_adc ));_cbga =0;_daa :for _daf ,_dad :=range _fbb {for _ ,_dge :=range _adc {if _daf ==_dge {continue _daa ;
};};_bgd [_cbga ]=_dad ;_cbga ++;};return _fbb ,nil ;};type OutputIntent struct{Object *_a .PdfObjectDictionary ;};