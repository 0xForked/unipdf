//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_b "errors";_d "fmt";_a "github.com/unidoc/unipdf/v3/common";_bc "github.com/unidoc/unipdf/v3/core";);type Catalog struct{Object *_bc .PdfObjectDictionary ;_bd *Document ;};func (_efd Page )GetContents ()([]Content ,bool ){_ecd ,_egf :=_bc .GetArray (_efd .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_egf {_def ,_ac :=_bc .GetStream (_efd .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_ac {return nil ,false ;};return []Content {{Stream :_def ,_eef :_efd ,_ffa :0}},true ;};_cde :=make ([]Content ,_ecd .Len ());for _gd ,_fe :=range _ecd .Elements (){_fc ,_beb :=_bc .GetStream (_fe );
if !_beb {continue ;};_cde [_gd ]=Content {Stream :_fc ,_eef :_efd ,_ffa :_gd };};return _cde ,true ;};func (_dd *OutputIntents )Add (oi _bc .PdfObject )error {_cbb ,_faa :=oi .(*_bc .PdfObjectDictionary );if !_faa {return _b .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _caa ,_egg :=_bc .GetStream (_cbb .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_egg {_dd ._aae .Objects =append (_dd ._aae .Objects ,_caa );};_ccb ,_da :=oi .(*_bc .PdfIndirectObject );
if !_da {_ccb =_bc .MakeIndirectObject (oi );};if _dd ._ce ==nil {_dd ._ce =_bc .MakeArray (_ccb );}else {_dd ._ce .Append (_ccb );};_dd ._aae .Objects =append (_dd ._aae .Objects ,_ccb );return nil ;};type OutputIntents struct{_ce *_bc .PdfObjectArray ;
_aae *Document ;_ceg *_bc .PdfIndirectObject ;};func (_ef *Catalog )GetMarkInfo ()(*_bc .PdfObjectDictionary ,bool ){_aa ,_fa :=_bc .GetDict (_ef .Object .Get ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f"));return _aa ,_fa ;};func (_dbe *Document )AddStream (stream *_bc .PdfObjectStream ){for _ ,_aee :=range _dbe .Objects {if _aee ==stream {return ;
};};_dbe .Objects =append (_dbe .Objects ,stream );};func (_bg *Catalog )HasMetadata ()bool {_eb :=_bg .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");return _eb !=nil ;};type Document struct{ID [2]string ;Version _bc .Version ;Objects []_bc .PdfObject ;
Info _bc .PdfObject ;Crypt *_bc .PdfCrypt ;UseHashBasedID bool ;};func (_bcd *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_cb :=_bcd .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");if _cb ==nil {return nil ,false ;
};_fac ,_efe :=_bc .GetIndirect (_cb );if !_efe {return nil ,false ;};_dc ,_ed :=_bc .GetArray (_fac .PdfObject );if !_ed {return nil ,false ;};return &OutputIntents {_ceg :_fac ,_ce :_dc ,_aae :_bcd ._bd },true ;};func (_c *Catalog )GetPages ()([]Page ,bool ){_ee ,_f :=_bc .GetDict (_c .Object .Get ("\u0050\u0061\u0067e\u0073"));
if !_f {return nil ,false ;};_ea ,_abe :=_bc .GetArray (_ee .Get ("\u004b\u0069\u0064\u0073"));if !_abe {return nil ,false ;};_cf :=make ([]Page ,_ea .Len ());for _db ,_df :=range _ea .Elements (){_ad ,_cg :=_bc .GetDict (_df );if !_cg {continue ;};_cf [_db ]=Page {Object :_ad ,_aed :_db +1,_abc :_c ._bd };
};return _cf ,true ;};func (_cfa *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_aae :_cfa ._bd }};func (_cfg *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _aac :=_cfg .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
_aac !=nil {for _be ,_aag :=range _cfg ._bd .Objects {if _aag ==_aac {if outputIntents ._ceg ==_aac {return ;};_cfg ._bd .Objects =append (_cfg ._bd .Objects [:_be ],_cfg ._bd .Objects [_be +1:]...);break ;};};};_eg :=outputIntents ._ceg ;if _eg ==nil {_eg =_bc .MakeIndirectObject (outputIntents ._ce );
};_cfg .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_eg );_cfg ._bd .Objects =append (_cfg ._bd .Objects ,_eg );};type Page struct{_aed int ;Object *_bc .PdfObjectDictionary ;_abc *Document ;};func (_bga *Document )FindCatalog ()(*Catalog ,bool ){var _adg *_bc .PdfObjectDictionary ;
for _ ,_ba :=range _bga .Objects {_caf ,_abd :=_bc .GetDict (_ba );if !_abd {continue ;};if _bcb ,_gc :=_bc .GetName (_caf .Get ("\u0054\u0079\u0070\u0065"));_gc &&*_bcb =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_adg =_caf ;break ;};};if _adg ==nil {return nil ,false ;
};return &Catalog {Object :_adg ,_bd :_bga },true ;};type OutputIntent struct{Object *_bc .PdfObjectDictionary ;};func (_deea *Page )Number ()int {return _deea ._aed };func _ff (_ccc _bc .PdfObject )(_bc .PdfObjectName ,error ){var _ffg *_bc .PdfObjectName ;
var _ffc *_bc .PdfObjectArray ;if _fbf ,_ffb :=_ccc .(*_bc .PdfIndirectObject );_ffb {if _bb ,_cdd :=_fbf .PdfObject .(*_bc .PdfObjectArray );_cdd {_ffc =_bb ;}else if _gf ,_gge :=_fbf .PdfObject .(*_bc .PdfObjectName );_gge {_ffg =_gf ;};}else if _bgb ,_fbb :=_ccc .(*_bc .PdfObjectArray );
_fbb {_ffc =_bgb ;}else if _efeb ,_bcc :=_ccc .(*_bc .PdfObjectName );_bcc {_ffg =_efeb ;};if _ffg !=nil {switch *_ffg {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_ffg ,nil ;
case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_ffg ,nil ;};};if _ffc !=nil &&_ffc .Len ()> 0{if _dg ,_aeed :=_ffc .Get (0).(*_bc .PdfObjectName );_aeed {switch *_dg {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _ffc .Len ()==1{return *_dg ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_dg ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_dg ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_dg ,nil ;};};};return "",nil ;};func (_eafg *Content )SetData (data []byte )error {_gbb ,_caad :=_bc .MakeStream (data ,_bc .NewFlateEncoder ());
if _caad !=nil {return _caad ;};_cdb ,_bge :=_bc .GetArray (_eafg ._eef .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_bge &&_eafg ._ffa ==0{_eafg ._eef .Object .Set ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073",_gbb );}else {if _caad =_cdb .Set (_eafg ._ffa ,_gbb );
_caad !=nil {return _caad ;};};_eafg ._eef ._abc .Objects =append (_eafg ._eef ._abc .Objects ,_gbb );return nil ;};func (_cc *Catalog )SetMetadata (data []byte )error {_ec ,_eaf :=_bc .MakeStream (data ,nil );if _eaf !=nil {return _eaf ;};_ec .Set ("\u0054\u0079\u0070\u0065",_bc .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));
_ec .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_bc .MakeName ("\u0058\u004d\u004c"));_cc .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_ec );_cc ._bd .Objects =append (_cc ._bd .Objects ,_ec );return nil ;};type ImageSMask struct{Image *Image ;
Stream *_bc .PdfObjectStream ;};func (_ab *Catalog )SetVersion (){_ab .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_bc .MakeName (_d .Sprintf ("\u0025\u0064\u002e%\u0064",_ab ._bd .Version .Major ,_ab ._bd .Version .Minor )));};func (_aef *Document )AddIndirectObject (indirect *_bc .PdfIndirectObject ){for _ ,_ced :=range _aef .Objects {if _ced ==indirect {return ;
};};_aef .Objects =append (_aef .Objects ,indirect );};func (_cac *Catalog )SetMarkInfo (mi _bc .PdfObject ){_fb :=_bc .MakeIndirectObject (mi );_cac .Object .Set ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f",_fb );_cac ._bd .Objects =append (_cac ._bd .Objects ,_fb );
};func (_eag Page )FindXObjectImages ()([]*Image ,error ){_bab ,_edf :=_eag .GetResourcesXObject ();if !_edf {return nil ,nil ;};var _gfa []*Image ;var _eeg error ;_efc :=map[*_bc .PdfObjectStream ]int {};_ag :=map[*_bc .PdfObjectStream ]struct{}{};var _ecf int ;
for _ ,_fca :=range _bab .Keys (){_cafd ,_cbe :=_bc .GetStream (_bab .Get (_fca ));if !_cbe {continue ;};if _ ,_fg :=_efc [_cafd ];_fg {continue ;};_bag ,_fbd :=_bc .GetName (_cafd .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_fbd ||_bag .String ()!="\u0049\u006d\u0061g\u0065"{continue ;
};_aaa :=Image {BitsPerComponent :8,Stream :_cafd ,Name :string (_fca )};if _aaa .Colorspace ,_eeg =_ff (_cafd .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));_eeg !=nil {_a .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_eeg );
continue ;};if _cda ,_fce :=_bc .GetIntVal (_cafd .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));_fce {_aaa .BitsPerComponent =_cda ;};if _abdf ,_eec :=_bc .GetIntVal (_cafd .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));
_eec {_aaa .Width =_abdf ;};if _dfe ,_fd :=_bc .GetIntVal (_cafd .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));_fd {_aaa .Height =_dfe ;};if _aaf ,_edd :=_bc .GetStream (_cafd .Get ("\u0053\u004d\u0061s\u006b"));_edd {_aaa .SMask =&ImageSMask {Image :&_aaa ,Stream :_aaf };
_ag [_aaf ]=struct{}{};};switch _aaa .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_aaa .ColorComponents =3;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_aaa .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_aaa .ColorComponents =4;
default:_aaa .ColorComponents =-1;};_efc [_cafd ]=_ecf ;_gfa =append (_gfa ,&_aaa );_ecf ++;};var _gfd []int ;for _ ,_cff :=range _gfa {if _cff .SMask !=nil {_add ,_fbfc :=_efc [_cff .SMask .Stream ];if _fbfc {_gfd =append (_gfd ,_add );};};};_ede :=make ([]*Image ,len (_gfa )-len (_gfd ));
_ecf =0;_cbec :for _bcbf ,_cegf :=range _gfa {for _ ,_age :=range _gfd {if _bcbf ==_age {continue _cbec ;};};_ede [_ecf ]=_cegf ;_ecf ++;};return _gfa ,nil ;};type Content struct{Stream *_bc .PdfObjectStream ;_ffa int ;_eef Page ;};func (_bbe Content )GetData ()([]byte ,error ){_dff ,_fdg :=_bc .NewEncoderFromStream (_bbe .Stream );
if _fdg !=nil {return nil ,_fdg ;};_edg ,_fdg :=_dff .DecodeStream (_bbe .Stream );if _fdg !=nil {return nil ,_fdg ;};return _edg ,nil ;};func (_bec *OutputIntents )Len ()int {return _bec ._ce .Len ()};func (_abg Page )GetResources ()(*_bc .PdfObjectDictionary ,bool ){return _bc .GetDict (_abg .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
};func (_aba *OutputIntents )Get (i int )(OutputIntent ,bool ){if _aba ._ce ==nil {return OutputIntent {},false ;};if i >=_aba ._ce .Len (){return OutputIntent {},false ;};_abab :=_aba ._ce .Get (i );_de ,_ecc :=_bc .GetIndirect (_abab );if !_ecc {_gg ,_eee :=_bc .GetDict (_abab );
return OutputIntent {Object :_gg },_eee ;};_bgd ,_gb :=_bc .GetDict (_de .PdfObject );return OutputIntent {Object :_bgd },_gb ;};func (_ae *Document )GetPages ()([]Page ,bool ){_dee ,_cd :=_ae .FindCatalog ();if !_cd {return nil ,false ;};return _dee .GetPages ();
};func (_eeec Page )FindXObjectForms ()[]*_bc .PdfObjectStream {_bdg ,_cce :=_eeec .GetResourcesXObject ();if !_cce {return nil ;};_aca :=map[*_bc .PdfObjectStream ]struct{}{};var _fed func (_beca *_bc .PdfObjectDictionary ,_fgc map[*_bc .PdfObjectStream ]struct{});
_fed =func (_gda *_bc .PdfObjectDictionary ,_dcf map[*_bc .PdfObjectStream ]struct{}){for _ ,_efebf :=range _gda .Keys (){_abcf ,_fee :=_bc .GetStream (_gda .Get (_efebf ));if !_fee {continue ;};if _ ,_ddb :=_dcf [_abcf ];_ddb {continue ;};_cgg ,_aec :=_bc .GetName (_abcf .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));
if !_aec ||_cgg .String ()!="\u0046\u006f\u0072\u006d"{continue ;};_dcf [_abcf ]=struct{}{};_eba ,_aec :=_bc .GetDict (_abcf .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));if !_aec {continue ;};_afe ,_ebe :=_bc .GetDict (_eba .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));
if _ebe {_fed (_afe ,_dcf );};};};_fed (_bdg ,_aca );var _deg []*_bc .PdfObjectStream ;for _dea :=range _aca {_deg =append (_deg ,_dea );};return _deg ;};type Image struct{Name string ;Width int ;Height int ;Colorspace _bc .PdfObjectName ;ColorComponents int ;
BitsPerComponent int ;SMask *ImageSMask ;Stream *_bc .PdfObjectStream ;};func (_eea *Catalog )GetMetadata ()(*_bc .PdfObjectStream ,bool ){_g ,_ca :=_bc .GetStream (_eea .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));return _g ,_ca ;
};func (_ega Page )GetResourcesXObject ()(*_bc .PdfObjectDictionary ,bool ){_ddc ,_deec :=_ega .GetResources ();if !_deec {return nil ,false ;};return _bc .GetDict (_ddc .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};