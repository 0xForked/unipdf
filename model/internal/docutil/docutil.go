//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_a "errors";_g "fmt";_ag "github.com/unidoc/unipdf/v3/common";_af "github.com/unidoc/unipdf/v3/core";);func (_afb *Document )GetPages ()([]Page ,bool ){_fa ,_gg :=_afb .FindCatalog ();if !_gg {return nil ,false ;};return _fa .GetPages ();
};type ImageSMask struct{Image *Image ;Stream *_af .PdfObjectStream ;};func (_aca *OutputIntents )Get (i int )(OutputIntent ,bool ){if _aca ._ddc ==nil {return OutputIntent {},false ;};if i >=_aca ._ddc .Len (){return OutputIntent {},false ;};_db :=_aca ._ddc .Get (i );
_dab ,_fbga :=_af .GetIndirect (_db );if !_fbga {_efc ,_eff :=_af .GetDict (_db );return OutputIntent {Object :_efc },_eff ;};_ca ,_adge :=_af .GetDict (_dab .PdfObject );return OutputIntent {Object :_ca },_adge ;};func (_ae *Catalog )SetVersion (){_ae .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_af .MakeName (_g .Sprintf ("\u0025\u0064\u002e%\u0064",_ae ._f .Version .Major ,_ae ._f .Version .Minor )));
};func (_aef *Catalog )GetPages ()([]Page ,bool ){_e ,_fb :=_af .GetDict (_aef .Object .Get ("\u0050\u0061\u0067e\u0073"));if !_fb {return nil ,false ;};_gc ,_fc :=_af .GetArray (_e .Get ("\u004b\u0069\u0064\u0073"));if !_fc {return nil ,false ;};_ea :=make ([]Page ,_gc .Len ());
for _ba ,_ac :=range _gc .Elements (){_d ,_age :=_af .GetDict (_ac );if !_age {continue ;};_ea [_ba ]=Page {Object :_d ,_bag :_ba +1,_fcec :_aef ._f };};return _ea ,true ;};type Catalog struct{Object *_af .PdfObjectDictionary ;_f *Document ;};func (_bb *Catalog )GetMarkInfo ()(*_af .PdfObjectDictionary ,bool ){_ef ,_gf :=_af .GetDict (_bb .Object .Get ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f"));
return _ef ,_gf ;};type Document struct{ID [2]string ;Version _af .Version ;Objects []_af .PdfObject ;Info _af .PdfObject ;Crypt *_af .PdfCrypt ;UseHashBasedID bool ;};type Content struct{Stream *_af .PdfObjectStream ;_effc int ;_aaba Page ;};func (_bfc Page )GetResourcesXObject ()(*_af .PdfObjectDictionary ,bool ){_baf ,_dcb :=_bfc .GetResources ();
if !_dcb {return nil ,false ;};return _af .GetDict (_baf .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};func (_fdc *Content )SetData (data []byte )error {_dbd ,_ffa :=_af .MakeStream (data ,_af .NewFlateEncoder ());if _ffa !=nil {return _ffa ;};_bada ,_ddgb :=_af .GetArray (_fdc ._aaba .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_ddgb &&_fdc ._effc ==0{_fdc ._aaba .Object .Set ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073",_dbd );}else {if _ffa =_bada .Set (_fdc ._effc ,_dbd );_ffa !=nil {return _ffa ;};};_fdc ._aaba ._fcec .Objects =append (_fdc ._aaba ._fcec .Objects ,_dbd );
return nil ;};func (_aab *OutputIntents )Len ()int {return _aab ._ddc .Len ()};func (_agb *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _gfc :=_agb .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
_gfc !=nil {for _fbg ,_bgd :=range _agb ._f .Objects {if _bgd ==_gfc {if outputIntents ._da ==_gfc {return ;};_agb ._f .Objects =append (_agb ._f .Objects [:_fbg ],_agb ._f .Objects [_fbg +1:]...);break ;};};};_afcc :=outputIntents ._da ;if _afcc ==nil {_afcc =_af .MakeIndirectObject (outputIntents ._ddc );
};_agb .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_afcc );_agb ._f .Objects =append (_agb ._f .Objects ,_afcc );};func (_bbe Page )GetResources ()(*_af .PdfObjectDictionary ,bool ){return _af .GetDict (_bbe .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
};func (_df *Catalog )SetMarkInfo (mi _af .PdfObject ){_ec :=_af .MakeIndirectObject (mi );_df .Object .Set ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f",_ec );_df ._f .Objects =append (_df ._f .Objects ,_ec );};func (_bga *Document )AddStream (stream *_af .PdfObjectStream ){for _ ,_beg :=range _bga .Objects {if _beg ==stream {return ;
};};_bga .Objects =append (_bga .Objects ,stream );};func _gea (_cfc _af .PdfObject )(_af .PdfObjectName ,error ){var _dec *_af .PdfObjectName ;var _gce *_af .PdfObjectArray ;if _cfcc ,_gb :=_cfc .(*_af .PdfIndirectObject );_gb {if _gbc ,_eaf :=_cfcc .PdfObject .(*_af .PdfObjectArray );
_eaf {_gce =_gbc ;}else if _gcf ,_fee :=_cfcc .PdfObject .(*_af .PdfObjectName );_fee {_dec =_gcf ;};}else if _dbf ,_ddg :=_cfc .(*_af .PdfObjectArray );_ddg {_gce =_dbf ;}else if _eb ,_dfe :=_cfc .(*_af .PdfObjectName );_dfe {_dec =_eb ;};if _dec !=nil {switch *_dec {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_dec ,nil ;
case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_dec ,nil ;};};if _gce !=nil &&_gce .Len ()> 0{if _dad ,_dfc :=_gce .Get (0).(*_af .PdfObjectName );_dfc {switch *_dad {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _gce .Len ()==1{return *_dad ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_dad ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_dad ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_dad ,nil ;};};};return "",nil ;};func (_cbg Content )GetData ()([]byte ,error ){_fde ,_fab :=_af .NewEncoderFromStream (_cbg .Stream );
if _fab !=nil {return nil ,_fab ;};_aebc ,_fab :=_fde .DecodeStream (_cbg .Stream );if _fab !=nil {return nil ,_fab ;};return _aebc ,nil ;};func (_dc *Catalog )HasMetadata ()bool {_c :=_dc .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");
return _c !=nil ;};type OutputIntent struct{Object *_af .PdfObjectDictionary ;};type Image struct{Name string ;Width int ;Height int ;Colorspace _af .PdfObjectName ;ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;Stream *_af .PdfObjectStream ;
};type Page struct{_bag int ;Object *_af .PdfObjectDictionary ;_fcec *Document ;};func (_aga *Document )FindCatalog ()(*Catalog ,bool ){var _gee *_af .PdfObjectDictionary ;for _ ,_bgg :=range _aga .Objects {_ce ,_fce :=_af .GetDict (_bgg );if !_fce {continue ;
};if _aff ,_fgc :=_af .GetName (_ce .Get ("\u0054\u0079\u0070\u0065"));_fgc &&*_aff =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_gee =_ce ;break ;};};if _gee ==nil {return nil ,false ;};return &Catalog {Object :_gee ,_f :_aga },true ;};func (_aabb *Document )AddIndirectObject (indirect *_af .PdfIndirectObject ){for _ ,_eab :=range _aabb .Objects {if _eab ==indirect {return ;
};};_aabb .Objects =append (_aabb .Objects ,indirect );};func (_afc *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_ddd :_afc ._f }};func (_feg Page )GetContents ()([]Content ,bool ){_ggd ,_fd :=_af .GetArray (_feg .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_fd {_dcf ,_dda :=_af .GetStream (_feg .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_dda {return nil ,false ;};return []Content {{Stream :_dcf ,_aaba :_feg ,_effc :0}},true ;};_bd :=make ([]Content ,_ggd .Len ());for _fae ,_bad :=range _ggd .Elements (){_ece ,_gdd :=_af .GetStream (_bad );
if !_gdd {continue ;};_bd [_fae ]=Content {Stream :_ece ,_aaba :_feg ,_effc :_fae };};return _bd ,true ;};func (_aa *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_cc :=_aa .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
if _cc ==nil {return nil ,false ;};_efa ,_bf :=_af .GetIndirect (_cc );if !_bf {return nil ,false ;};_fg ,_adg :=_af .GetArray (_efa .PdfObject );if !_adg {return nil ,false ;};return &OutputIntents {_da :_efa ,_ddc :_fg ,_ddd :_aa ._f },true ;};func (_ge *Catalog )GetMetadata ()(*_af .PdfObjectStream ,bool ){_cf ,_dd :=_af .GetStream (_ge .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));
return _cf ,_dd ;};func (_de *OutputIntents )Add (oi _af .PdfObject )error {_cd ,_adgd :=oi .(*_af .PdfObjectDictionary );if !_adgd {return _a .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _gd ,_fe :=_af .GetStream (_cd .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_fe {_de ._ddd .Objects =append (_de ._ddd .Objects ,_gd );};_bgf ,_bba :=oi .(*_af .PdfIndirectObject );if !_bba {_bgf =_af .MakeIndirectObject (oi );
};if _de ._ddc ==nil {_de ._ddc =_af .MakeArray (_bgf );}else {_de ._ddc .Append (_bgf );};_de ._ddd .Objects =append (_de ._ddd .Objects ,_bgf );return nil ;};func (_dba *Page )Number ()int {return _dba ._bag };func (_dade Page )FindXObjectForms ()[]*_af .PdfObjectStream {_cg ,_bgda :=_dade .GetResourcesXObject ();
if !_bgda {return nil ;};_ggdg :=map[*_af .PdfObjectStream ]struct{}{};var _gae func (_edc *_af .PdfObjectDictionary ,_cbd map[*_af .PdfObjectStream ]struct{});_gae =func (_bc *_af .PdfObjectDictionary ,_cab map[*_af .PdfObjectStream ]struct{}){for _ ,_dddf :=range _bc .Keys (){_affe ,_cdf :=_af .GetStream (_bc .Get (_dddf ));
if !_cdf {continue ;};if _ ,_fbgc :=_cab [_affe ];_fbgc {continue ;};_bbg ,_dce :=_af .GetName (_affe .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_dce ||_bbg .String ()!="\u0046\u006f\u0072\u006d"{continue ;};_cab [_affe ]=struct{}{};_caf ,_dce :=_af .GetDict (_affe .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
if !_dce {continue ;};_cag ,_bgfg :=_af .GetDict (_caf .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));if _bgfg {_gae (_cag ,_cab );};};};_gae (_cg ,_ggdg );var _bbc []*_af .PdfObjectStream ;for _cffe :=range _ggdg {_bbc =append (_bbc ,_cffe );};return _bbc ;
};type OutputIntents struct{_ddc *_af .PdfObjectArray ;_ddd *Document ;_da *_af .PdfIndirectObject ;};func (_be *Catalog )SetMetadata (data []byte )error {_bg ,_ad :=_af .MakeStream (data ,nil );if _ad !=nil {return _ad ;};_bg .Set ("\u0054\u0079\u0070\u0065",_af .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));
_bg .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_af .MakeName ("\u0058\u004d\u004c"));_be .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_bg );_be ._f .Objects =append (_be ._f .Objects ,_bg );return nil ;};func (_aac Page )FindXObjectImages ()([]*Image ,error ){_aeb ,_bge :=_aac .GetResourcesXObject ();
if !_bge {return nil ,nil ;};var _fcg []*Image ;var _bff error ;_fac :=map[*_af .PdfObjectStream ]int {};_bea :=map[*_af .PdfObjectStream ]struct{}{};var _afd int ;for _ ,_feb :=range _aeb .Keys (){_ed ,_cee :=_af .GetStream (_aeb .Get (_feb ));if !_cee {continue ;
};if _ ,_febc :=_fac [_ed ];_febc {continue ;};_ff ,_gbcd :=_af .GetName (_ed .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_gbcd ||_ff .String ()!="\u0049\u006d\u0061g\u0065"{continue ;};_fca :=Image {BitsPerComponent :8,Stream :_ed ,Name :string (_feb )};
if _fca .Colorspace ,_bff =_gea (_ed .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));_bff !=nil {_ag .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_bff );
continue ;};if _dece ,_ga :=_af .GetIntVal (_ed .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));_ga {_fca .BitsPerComponent =_dece ;};if _eg ,_ee :=_af .GetIntVal (_ed .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));
_ee {_fca .Width =_eg ;};if _fba ,_fed :=_af .GetIntVal (_ed .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));_fed {_fca .Height =_fba ;};if _cba ,_gaa :=_af .GetStream (_ed .Get ("\u0053\u004d\u0061s\u006b"));_gaa {_fca .SMask =&ImageSMask {Image :&_fca ,Stream :_cba };
_bea [_cba ]=struct{}{};};switch _fca .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_fca .ColorComponents =3;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_fca .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_fca .ColorComponents =4;
default:_fca .ColorComponents =-1;};_fac [_ed ]=_afd ;_fcg =append (_fcg ,&_fca );_afd ++;};var _gef []int ;for _ ,_bef :=range _fcg {if _bef .SMask !=nil {_fge ,_adf :=_fac [_bef .SMask .Stream ];if _adf {_gef =append (_gef ,_fge );};};};_ceb :=make ([]*Image ,len (_fcg )-len (_gef ));
_afd =0;_cff :for _ebd ,_dbg :=range _fcg {for _ ,_eda :=range _gef {if _ebd ==_eda {continue _cff ;};};_ceb [_afd ]=_dbg ;_afd ++;};return _fcg ,nil ;};