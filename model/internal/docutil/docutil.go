//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_b "errors";_e "fmt";_ce "github.com/unidoc/unipdf/v3/common";_c "github.com/unidoc/unipdf/v3/core";_a "github.com/unidoc/unipdf/v3/internal/xmp";);func (_fb *Document )AddStream (stream *_c .PdfObjectStream ){for _ ,_bca :=range _fb .Objects {if _bca ==stream {return ;
};};_fb .Objects =append (_fb .Objects ,stream );};type OutputIntents struct{_cff *_c .PdfObjectArray ;_acg *Document ;_bde *_c .PdfIndirectObject ;};func (_ed *OutputIntents )Add (oi _c .PdfObject )error {_bdg ,_bf :=oi .(*_c .PdfObjectDictionary );if !_bf {return _b .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _ede ,_adb :=_c .GetStream (_bdg .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_adb {_ed ._acg .Objects =append (_ed ._acg .Objects ,_ede );};_bc ,_cb :=oi .(*_c .PdfIndirectObject );if !_cb {_bc =_c .MakeIndirectObject (oi );
};if _ed ._cff ==nil {_ed ._cff =_c .MakeArray (_bc );}else {_ed ._cff .Append (_bc );};_ed ._acg .Objects =append (_ed ._acg .Objects ,_bc );return nil ;};type OutputIntent struct{Object *_c .PdfObjectDictionary ;};func (_fgf *Page )Number ()int {return _fgf ._ffa };
func (_df *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _cgdd :=_df .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");_cgdd !=nil {for _ab ,_ac :=range _df ._g .Objects {if _ac ==_cgdd {if outputIntents ._bde ==_cgdd {return ;
};_df ._g .Objects =append (_df ._g .Objects [:_ab ],_df ._g .Objects [_ab +1:]...);break ;};};};_ga :=outputIntents ._bde ;if _ga ==nil {_ga =_c .MakeIndirectObject (outputIntents ._cff );};_df .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_ga );
_df ._g .Objects =append (_df ._g .Objects ,_ga );};func (_cf *Catalog )GetPages ()([]Page ,bool ){_fa ,_ff :=_c .GetDict (_cf .Object .Get ("\u0050\u0061\u0067e\u0073"));if !_ff {return nil ,false ;};_ad ,_d :=_c .GetArray (_fa .Get ("\u004b\u0069\u0064\u0073"));
if !_d {return nil ,false ;};_bd :=make ([]Page ,_ad .Len ());for _ffb ,_cec :=range _ad .Elements (){_fag ,_bb :=_c .GetDict (_cec );if !_bb {continue ;};_bd [_ffb ]=Page {Object :_fag ,_ffa :_ffb +1,_bdgg :_cf ._g };};return _bd ,true ;};func (_ffg *Document )GetPages ()([]Page ,bool ){_gg ,_ggb :=_ffg .FindCatalog ();
if !_ggb {return nil ,false ;};return _gg .GetPages ();};func (_ef *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_acg :_ef ._g }};type ImageSMask struct{Image *Image ;Stream *_c .PdfObjectStream ;};func (_bcaf Page )FindXObjectImages ()([]*Image ,error ){_acd ,_eae :=_bcaf .GetResourcesXObject ();
if !_eae {return nil ,nil ;};var _cac []*Image ;var _cd error ;_dce :=map[*_c .PdfObjectStream ]int {};_deg :=map[*_c .PdfObjectStream ]struct{}{};var _gdcb int ;for _ ,_efb :=range _acd .Keys (){_eaf ,_fad :=_c .GetStream (_acd .Get (_efb ));if !_fad {continue ;
};if _ ,_dcb :=_dce [_eaf ];_dcb {continue ;};_fdb ,_ffc :=_c .GetName (_eaf .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_ffc ||_fdb .String ()!="\u0049\u006d\u0061g\u0065"{continue ;};_fgbde :=Image {BitsPerComponent :8,Stream :_eaf ,Name :string (_efb )};
if _fgbde .Colorspace ,_cd =_db (_eaf .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));_cd !=nil {_ce .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_cd );
continue ;};if _baf ,_edca :=_c .GetIntVal (_eaf .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));_edca {_fgbde .BitsPerComponent =_baf ;};if _eaa ,_cdg :=_c .GetIntVal (_eaf .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));
_cdg {_fgbde .Width =_eaa ;};if _gee ,_gbc :=_c .GetIntVal (_eaf .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));_gbc {_fgbde .Height =_gee ;};if _aac ,_eg :=_c .GetStream (_eaf .Get ("\u0053\u004d\u0061s\u006b"));_eg {_fgbde .SMask =&ImageSMask {Image :&_fgbde ,Stream :_aac };
_deg [_aac ]=struct{}{};};switch _fgbde .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_fgbde .ColorComponents =3;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_fgbde .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_fgbde .ColorComponents =4;
default:_fgbde .ColorComponents =-1;};_dce [_eaf ]=_gdcb ;_cac =append (_cac ,&_fgbde );_gdcb ++;};var _fbg []int ;for _ ,_abd :=range _cac {if _abd .SMask !=nil {_gda ,_cee :=_dce [_abd .SMask .Stream ];if _cee {_fbg =append (_fbg ,_gda );};};};_edf :=make ([]*Image ,len (_cac )-len (_fbg ));
_gdcb =0;_efba :for _gdde ,_cacf :=range _cac {for _ ,_ebf :=range _fbg {if _gdde ==_ebf {continue _efba ;};};_edf [_gdcb ]=_cacf ;_gdcb ++;};return _cac ,nil ;};func (_cg *Catalog )SetVersion (){_cg .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_c .MakeName (_e .Sprintf ("\u0025\u0064\u002e%\u0064",_cg ._g .Version .Major ,_cg ._g .Version .Minor )));
};func _db (_gbe _c .PdfObject )(_c .PdfObjectName ,error ){var _bgd *_c .PdfObjectName ;var _beg *_c .PdfObjectArray ;if _eb ,_cc :=_gbe .(*_c .PdfIndirectObject );_cc {if _bgdf ,_cae :=_eb .PdfObject .(*_c .PdfObjectArray );_cae {_beg =_bgdf ;}else if _gdc ,_bbe :=_eb .PdfObject .(*_c .PdfObjectName );
_bbe {_bgd =_gdc ;};}else if _gff ,_fdc :=_gbe .(*_c .PdfObjectArray );_fdc {_beg =_gff ;}else if _ba ,_fdd :=_gbe .(*_c .PdfObjectName );_fdd {_bgd =_ba ;};if _bgd !=nil {switch *_bgd {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_bgd ,nil ;
case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_bgd ,nil ;};};if _beg !=nil &&_beg .Len ()> 0{if _aea ,_ffbc :=_beg .Get (0).(*_c .PdfObjectName );_ffbc {switch *_aea {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _beg .Len ()==1{return *_aea ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_aea ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_aea ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_aea ,nil ;};};};return "",nil ;};func (_ffbg *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_ea :=_ffbg .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
if _ea ==nil {return nil ,false ;};_ddd ,_ae :=_c .GetIndirect (_ea );if !_ae {return nil ,false ;};_ag ,_ca :=_c .GetArray (_ddd .PdfObject );if !_ca {return nil ,false ;};return &OutputIntents {_bde :_ddd ,_cff :_ag ,_acg :_ffbg ._g },true ;};func (_ade Page )GetContents ()([]Content ,bool ){_abb ,_efae :=_c .GetArray (_ade .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_efae {return nil ,false ;};_abbc :=make ([]Content ,_abb .Len ());for _fbc ,_edc :=range _abb .Elements (){_abbc [_fbc ]=Content {Object :_edc };};return _abbc ,true ;};type Image struct{Name string ;Width int ;Height int ;Colorspace _c .PdfObjectName ;
ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;Stream *_c .PdfObjectStream ;};func (_ee *Document )FindCatalog ()(*Catalog ,bool ){var _da *_c .PdfObjectDictionary ;for _ ,_bg :=range _ee .Objects {_gf ,_fg :=_c .GetDict (_bg );if !_fg {continue ;
};if _fgb ,_be :=_c .GetName (_gf .Get ("\u0054\u0079\u0070\u0065"));_be &&*_fgb =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_da =_gf ;break ;};};if _da ==nil {return nil ,false ;};return &Catalog {Object :_da ,_g :_ee },true ;};func (_fd *Catalog )SetMetadata (meta _a .Metadata )error {_dd ,_cgd :=meta .MarshalXMP ();
if _cgd !=nil {return _cgd ;};_dde ,_cgd :=_c .MakeStream (_dd ,nil );if _cgd !=nil {return _cgd ;};_dde .Set ("\u0054\u0079\u0070\u0065",_c .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));_dde .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_c .MakeName ("\u0058\u004d\u004c"));
_fd .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_dde );_fd ._g .Objects =append (_fd ._g .Objects ,_dde );return nil ;};func (_gc *Catalog )HasMetadata ()bool {_gd :=_gc .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");
return _gd !=nil ;};type Page struct{_ffa int ;Object *_c .PdfObjectDictionary ;_bdgg *Document ;};func (_gb *OutputIntents )Len ()int {return _gb ._cff .Len ()};func (_dc Page )GetResources ()(*_c .PdfObjectDictionary ,bool ){return _c .GetDict (_dc .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
};func (_gdda Content )GetData ()([]byte ,error ){_eeg ,_bgb :=_c .GetStream (_gdda .Object );if !_bgb {return nil ,nil ;};_gba ,_fba :=_c .NewEncoderFromStream (_eeg );if _fba !=nil {return nil ,_fba ;};_dbf ,_fba :=_gba .DecodeStream (_eeg );if _fba !=nil {return nil ,_fba ;
};return _dbf ,nil ;};type Catalog struct{Object *_c .PdfObjectDictionary ;_g *Document ;};func (_fgbd *Document )AddIndirectObject (indirect *_c .PdfIndirectObject ){for _ ,_fda :=range _fgbd .Objects {if _fda ==indirect {return ;};};_fgbd .Objects =append (_fgbd .Objects ,indirect );
};type Document struct{ID [2]string ;Version _c .Version ;Objects []_c .PdfObject ;Info _c .PdfObject ;Crypt *_c .PdfCrypt ;UseHashBasedID bool ;};type Content struct{Object _c .PdfObject ;};func (_aa Page )GetResourcesXObject ()(*_c .PdfObjectDictionary ,bool ){_ead ,_ge :=_aa .GetResources ();
if !_ge {return nil ,false ;};return _c .GetDict (_ead .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};func (_efa *OutputIntents )Get (i int )(OutputIntent ,bool ){if _efa ._cff ==nil {return OutputIntent {},false ;};if i >=_efa ._cff .Len (){return OutputIntent {},false ;
};_de :=_efa ._cff .Get (i );_fc ,_dg :=_c .GetIndirect (_de );if !_dg {_gdd ,_ec :=_c .GetDict (_de );return OutputIntent {Object :_gdd },_ec ;};_fce ,_dgg :=_c .GetDict (_fc .PdfObject );return OutputIntent {Object :_fce },_dgg ;};