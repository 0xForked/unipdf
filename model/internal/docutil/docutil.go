//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_d "errors";_e "fmt";_c "github.com/unidoc/unipdf/v3/common";_bd "github.com/unidoc/unipdf/v3/core";);func (_ege *OutputIntents )Len ()int {return _ege ._gbf .Len ()};type Catalog struct{Object *_bd .PdfObjectDictionary ;_cf *Document ;
};func (_gc *Document )FindCatalog ()(*Catalog ,bool ){var _dacg *_bd .PdfObjectDictionary ;for _ ,_ac :=range _gc .Objects {_aa ,_ddf :=_bd .GetDict (_ac );if !_ddf {continue ;};if _fde ,_egg :=_bd .GetName (_aa .Get ("\u0054\u0079\u0070\u0065"));_egg &&*_fde =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_dacg =_aa ;
break ;};};if _dacg ==nil {return nil ,false ;};return &Catalog {Object :_dacg ,_cf :_gc },true ;};func (_ddc *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_de :=_ddc .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
if _de ==nil {return nil ,false ;};_fbb ,_eba :=_bd .GetIndirect (_de );if !_eba {return nil ,false ;};_cd ,_fc :=_bd .GetArray (_fbb .PdfObject );if !_fc {return nil ,false ;};return &OutputIntents {_a :_fbb ,_gbf :_cd ,_bf :_ddc ._cf },true ;};func (_cc *Catalog )GetMarkInfo ()(*_bd .PdfObjectDictionary ,bool ){_dg ,_cfe :=_bd .GetDict (_cc .Object .Get ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f"));
return _dg ,_cfe ;};func (_ggf *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_bf :_ggf ._cf }};func (_bb *OutputIntents )Get (i int )(OutputIntent ,bool ){if _bb ._gbf ==nil {return OutputIntent {},false ;};if i >=_bb ._gbf .Len (){return OutputIntent {},false ;
};_ca :=_bb ._gbf .Get (i );_gae ,_ce :=_bd .GetIndirect (_ca );if !_ce {_bff ,_ee :=_bd .GetDict (_ca );return OutputIntent {Object :_bff },_ee ;};_ff ,_dcd :=_bd .GetDict (_gae .PdfObject );return OutputIntent {Object :_ff },_dcd ;};func (_fbg *Document )GetPages ()([]Page ,bool ){_dda ,_ddca :=_fbg .FindCatalog ();
if !_ddca {return nil ,false ;};return _dda .GetPages ();};func (_beaf Page )GetResourcesXObject ()(*_bd .PdfObjectDictionary ,bool ){_ec ,_ab :=_beaf .GetResources ();if !_ab {return nil ,false ;};return _bd .GetDict (_ec .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));
};type Image struct{Name string ;Width int ;Height int ;Colorspace _bd .PdfObjectName ;ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;Stream *_bd .PdfObjectStream ;};func (_bc *Catalog )SetMetadata (data []byte )error {_be ,_gg :=_bd .MakeStream (data ,nil );
if _gg !=nil {return _gg ;};_be .Set ("\u0054\u0079\u0070\u0065",_bd .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));_be .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_bd .MakeName ("\u0058\u004d\u004c"));_bc .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_be );
_bc ._cf .Objects =append (_bc ._cf .Objects ,_be );return nil ;};func (_cfg Page )GetResources ()(*_bd .PdfObjectDictionary ,bool ){return _bd .GetDict (_cfg .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));};type OutputIntent struct{Object *_bd .PdfObjectDictionary ;
};type OutputIntents struct{_gbf *_bd .PdfObjectArray ;_bf *Document ;_a *_bd .PdfIndirectObject ;};func (_gf *Catalog )GetMetadata ()(*_bd .PdfObjectStream ,bool ){_fb ,_ga :=_bd .GetStream (_gf .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));
return _fb ,_ga ;};func (_bg *Catalog )HasMetadata ()bool {_gd :=_bg .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");return _gd !=nil ;};func (_ffb *Document )AddIndirectObject (indirect *_bd .PdfIndirectObject ){for _ ,_ge :=range _ffb .Objects {if _ge ==indirect {return ;
};};_ffb .Objects =append (_ffb .Objects ,indirect );};func (_eb *Catalog )GetPages ()([]Page ,bool ){_da ,_daf :=_bd .GetDict (_eb .Object .Get ("\u0050\u0061\u0067e\u0073"));if !_daf {return nil ,false ;};_f ,_g :=_bd .GetArray (_da .Get ("\u004b\u0069\u0064\u0073"));
if !_g {return nil ,false ;};_ef :=make ([]Page ,_f .Len ());for _dd ,_dc :=range _f .Elements (){_df ,_gb :=_bd .GetDict (_dc );if !_gb {continue ;};_ef [_dd ]=Page {Object :_df ,_bbc :_dd +1,_ggd :_eb ._cf };};return _ef ,true ;};func (_bfe Page )FindXObjectForms ()[]*_bd .PdfObjectStream {_cef ,_edaf :=_bfe .GetResourcesXObject ();
if !_edaf {return nil ;};_acf :=map[*_bd .PdfObjectStream ]struct{}{};var _ag func (_deb *_bd .PdfObjectDictionary ,_debc map[*_bd .PdfObjectStream ]struct{});_ag =func (_bef *_bd .PdfObjectDictionary ,_bdge map[*_bd .PdfObjectStream ]struct{}){for _ ,_gga :=range _bef .Keys (){_bbb ,_dcc :=_bd .GetStream (_bef .Get (_gga ));
if !_dcc {continue ;};if _ ,_ebb :=_bdge [_bbb ];_ebb {continue ;};_dde ,_bfbb :=_bd .GetName (_bbb .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_bfbb ||_dde .String ()!="\u0046\u006f\u0072\u006d"{continue ;};_bdge [_bbb ]=struct{}{};_dgc ,_bfbb :=_bd .GetDict (_bbb .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
if !_bfbb {continue ;};_agc ,_bbg :=_bd .GetDict (_dgc .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));if _bbg {_ag (_agc ,_bdge );};};};_ag (_cef ,_acf );var _ccc []*_bd .PdfObjectStream ;for _dff :=range _acf {_ccc =append (_ccc ,_dff );};return _ccc ;
};func (_bcb *Catalog )SetMarkInfo (mi _bd .PdfObject ){_eg :=_bd .MakeIndirectObject (mi );_bcb .Object .Set ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f",_eg );_bcb ._cf .Objects =append (_bcb ._cf .Objects ,_eg );};func (_cb *Page )Number ()int {return _cb ._bbc };
func (_bdg *Catalog )SetVersion (){_bdg .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_bd .MakeName (_e .Sprintf ("\u0025\u0064\u002e%\u0064",_bdg ._cf .Version .Major ,_bdg ._cf .Version .Minor )));};func (_dab *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _db :=_dab .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
_db !=nil {for _beb ,_bgb :=range _dab ._cf .Objects {if _bgb ==_db {if outputIntents ._a ==_db {return ;};_dab ._cf .Objects =append (_dab ._cf .Objects [:_beb ],_dab ._cf .Objects [_beb +1:]...);break ;};};};_fg :=outputIntents ._a ;if _fg ==nil {_fg =_bd .MakeIndirectObject (outputIntents ._gbf );
};_dab .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_fg );_dab ._cf .Objects =append (_dab ._cf .Objects ,_fg );};type Page struct{_bbc int ;Object *_bd .PdfObjectDictionary ;_ggd *Document ;};func (_bgd *Document )AddStream (stream *_bd .PdfObjectStream ){for _ ,_fcb :=range _bgd .Objects {if _fcb ==stream {return ;
};};_bgd .Objects =append (_bgd .Objects ,stream );};type Document struct{ID [2]string ;Version _bd .Version ;Objects []_bd .PdfObject ;Info _bd .PdfObject ;Crypt *_bd .PdfCrypt ;UseHashBasedID bool ;};func (_beg *OutputIntents )Add (oi _bd .PdfObject )error {_ddg ,_fd :=oi .(*_bd .PdfObjectDictionary );
if !_fd {return _d .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _dac ,_cdc :=_bd .GetStream (_ddg .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_cdc {_beg ._bf .Objects =append (_beg ._bf .Objects ,_dac );};_bea ,_af :=oi .(*_bd .PdfIndirectObject );
if !_af {_bea =_bd .MakeIndirectObject (oi );};if _beg ._gbf ==nil {_beg ._gbf =_bd .MakeArray (_bea );}else {_beg ._gbf .Append (_bea );};_beg ._bf .Objects =append (_beg ._bf .Objects ,_bea );return nil ;};func (_bega Page )GetContents ()([]Content ,bool ){_bec ,_ccd :=_bd .GetArray (_bega .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_ccd {_aag ,_eda :=_bd .GetStream (_bega .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_eda {return nil ,false ;};return []Content {{Stream :_aag ,_gefb :_bega ,_ddgf :0}},true ;};_bcf :=make ([]Content ,_bec .Len ());for _bdbd ,_bbe :=range _bec .Elements (){_ddgc ,_cfc :=_bd .GetStream (_bbe );
if !_cfc {continue ;};_bcf [_bdbd ]=Content {Stream :_ddgc ,_gefb :_bega ,_ddgf :_bdbd };};return _bcf ,true ;};func _gef (_caf _bd .PdfObject )(_bd .PdfObjectName ,error ){var _gda *_bd .PdfObjectName ;var _dfe *_bd .PdfObjectArray ;if _ed ,_bga :=_caf .(*_bd .PdfIndirectObject );
_bga {if _eec ,_fa :=_ed .PdfObject .(*_bd .PdfObjectArray );_fa {_dfe =_eec ;}else if _aeg ,_cdcd :=_ed .PdfObject .(*_bd .PdfObjectName );_cdcd {_gda =_aeg ;};}else if _cae ,_eeb :=_caf .(*_bd .PdfObjectArray );_eeb {_dfe =_cae ;}else if _dbc ,_caec :=_caf .(*_bd .PdfObjectName );
_caec {_gda =_dbc ;};if _gda !=nil {switch *_gda {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_gda ,nil ;case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_gda ,nil ;
};};if _dfe !=nil &&_dfe .Len ()> 0{if _gaa ,_bee :=_dfe .Get (0).(*_bd .PdfObjectName );_bee {switch *_gaa {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _dfe .Len ()==1{return *_gaa ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_gaa ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_gaa ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_gaa ,nil ;};};};return "",nil ;};type Content struct{Stream *_bd .PdfObjectStream ;_ddgf int ;_gefb Page ;};func (_cfcb *Content )SetData (data []byte )error {_eaf ,_dgcf :=_bd .MakeStream (data ,_bd .NewFlateEncoder ());
if _dgcf !=nil {return _dgcf ;};_dfef ,_cdea :=_bd .GetArray (_cfcb ._gefb .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_cdea &&_cfcb ._ddgf ==0{_cfcb ._gefb .Object .Set ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073",_eaf );
}else {if _dgcf =_dfef .Set (_cfcb ._ddgf ,_eaf );_dgcf !=nil {return _dgcf ;};};_cfcb ._gefb ._ggd .Objects =append (_cfcb ._gefb ._ggd .Objects ,_eaf );return nil ;};type ImageSMask struct{Image *Image ;Stream *_bd .PdfObjectStream ;};func (_gbg Page )FindXObjectImages ()([]*Image ,error ){_aec ,_dee :=_gbg .GetResourcesXObject ();
if !_dee {return nil ,nil ;};var _gbc []*Image ;var _fbgd error ;_bdd :=map[*_bd .PdfObjectStream ]int {};_aac :=map[*_bd .PdfObjectStream ]struct{}{};var _gcb int ;for _ ,_bgg :=range _aec .Keys (){_bgac ,_abc :=_bd .GetStream (_aec .Get (_bgg ));if !_abc {continue ;
};if _ ,_afg :=_bdd [_bgac ];_afg {continue ;};_dec ,_dgf :=_bd .GetName (_bgac .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_dgf ||_dec .String ()!="\u0049\u006d\u0061g\u0065"{continue ;};_gca :=Image {BitsPerComponent :8,Stream :_bgac ,Name :string (_bgg )};
if _gca .Colorspace ,_fbgd =_gef (_bgac .PdfObjectDictionary .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));_fbgd !=nil {_c .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_fbgd );
continue ;};if _acd ,_acc :=_bd .GetIntVal (_bgac .PdfObjectDictionary .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));_acc {_gca .BitsPerComponent =_acd ;};if _gad ,_aagf :=_bd .GetIntVal (_bgac .PdfObjectDictionary .Get ("\u0057\u0069\u0064t\u0068"));
_aagf {_gca .Width =_gad ;};if _fcf ,_fcfc :=_bd .GetIntVal (_bgac .PdfObjectDictionary .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));_fcfc {_gca .Height =_fcf ;};if _ccg ,_ded :=_bd .GetStream (_bgac .Get ("\u0053\u004d\u0061s\u006b"));_ded {_gca .SMask =&ImageSMask {Image :&_gca ,Stream :_ccg };
_aac [_ccg ]=struct{}{};};switch _gca .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_gca .ColorComponents =3;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_gca .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_gca .ColorComponents =4;
default:_gca .ColorComponents =-1;};_bdd [_bgac ]=_gcb ;_gbc =append (_gbc ,&_gca );_gcb ++;};var _ccf []int ;for _ ,_ced :=range _gbc {if _ced .SMask !=nil {_ada ,_dgb :=_bdd [_ced .SMask .Stream ];if _dgb {_ccf =append (_ccf ,_ada );};};};_gaac :=make ([]*Image ,len (_gbc )-len (_ccf ));
_gcb =0;_ggfe :for _dfc ,_acg :=range _gbc {for _ ,_bfb :=range _ccf {if _dfc ==_bfb {continue _ggfe ;};};_gaac [_gcb ]=_acg ;_gcb ++;};return _gbc ,nil ;};func (_gfg Content )GetData ()([]byte ,error ){_cde ,_faa :=_bd .NewEncoderFromStream (_gfg .Stream );
if _faa !=nil {return nil ,_faa ;};_agb ,_faa :=_cde .DecodeStream (_gfg .Stream );if _faa !=nil {return nil ,_faa ;};return _agb ,nil ;};