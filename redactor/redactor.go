//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package redactor ;import (_c "errors";_a "fmt";_b "github.com/unidoc/unipdf/v3/common";_gfd "github.com/unidoc/unipdf/v3/contentstream";_cg "github.com/unidoc/unipdf/v3/core";_eb "github.com/unidoc/unipdf/v3/creator";_fd "github.com/unidoc/unipdf/v3/extractor";
_dc "github.com/unidoc/unipdf/v3/model";_e "io";_gf "regexp";_d "sort";_f "strings";);type localSpanMarks struct{_fagb *_fd .TextMarkArray ;_gce int ;_bgcf string ;};func _bab (_dfe localSpanMarks ,_cab *_fd .TextMarkArray ,_dgb *_dc .PdfFont ,_ddg ,_bea string )([]_cg .PdfObject ,error ){_eae :=_feg (_cab );
Tj ,_fdc :=_ddgg (_cab );if _fdc !=nil {return nil ,_fdc ;};_bef :=len (_ddg );_gbd :=len (_eae );_fce :=-1;_cgb :=_cg .MakeFloat (Tj );if _eae !=_bea {_dbb :=_dfe ._gce ;if _dbb ==0{_fce =_f .LastIndex (_ddg ,_eae );}else {_fce =_f .Index (_ddg ,_eae );
};}else {_fce =_f .Index (_ddg ,_eae );};_efaf :=_fce +_gbd ;_dbg :=[]_cg .PdfObject {};if _fce ==0&&_efaf ==_bef {_dbg =append (_dbg ,_cgb );}else if _fce ==0&&_efaf < _bef {_gda :=_ce (_ddg [_efaf :],_dgb );_cae :=_cg .MakeStringFromBytes (_gda );_dbg =append (_dbg ,_cgb ,_cae );
}else if _fce > 0&&_efaf >=_bef {_dfd :=_ce (_ddg [:_fce ],_dgb );_edge :=_cg .MakeStringFromBytes (_dfd );_dbg =append (_dbg ,_edge ,_cgb );}else if _fce > 0&&_efaf < _bef {_eaa :=_ce (_ddg [:_fce ],_dgb );_egg :=_ce (_ddg [_efaf :],_dgb );_baaa :=_cg .MakeStringFromBytes (_eaa );
_cabf :=_cg .MakeString (string (_egg ));_dbg =append (_dbg ,_baaa ,_cgb ,_cabf );};return _dbg ,nil ;};func _abe (_ffbb string ,_dac []localSpanMarks )([]placeHolders ,error ){_eadf :="";_ddbg :=[]placeHolders {};for _affb ,_bfb :=range _dac {_dfg :=_bfb ._fagb ;
_eead :=_bfb ._bgcf ;_eac :=_feg (_dfg );_gdab ,_gge :=_ddgg (_dfg );if _gge !=nil {return nil ,_gge ;};if _eac !=_eadf {var _ecf []int ;if _affb ==0&&_eead !=_eac {_dba :=_f .Index (_ffbb ,_eac );_ecf =[]int {_dba };}else if _affb ==len (_dac )-1{_efad :=_f .LastIndex (_ffbb ,_eac );
_ecf =[]int {_efad };}else {_ecf =_beb (_ffbb ,_eac );};_bgag :=placeHolders {_bc :_ecf ,_ec :_eac ,_bce :_gdab };_ddbg =append (_ddbg ,_bgag );};_eadf =_eac ;};return _ddbg ,nil ;};func _cbbc (_cfaa int ,_cbba []int )bool {for _ ,_cgc :=range _cbba {if _cgc ==_cfaa {return true ;
};};return false ;};func _gfg (_fdec ,_edb targetMap )(bool ,[]int ){_efca :=_f .Contains (_fdec ._ddgb ,_edb ._ddgb );var _afgg []int ;for _ ,_bfg :=range _fdec ._dfge {for _ffa ,_ggeb :=range _edb ._dfge {if _ggeb [0]>=_bfg [0]&&_ggeb [1]<=_bfg [1]{_afgg =append (_afgg ,_ffa );
};};};return _efca ,_afgg ;};func _gb (_ggb *_fd .TextMarkArray )(_cg .PdfObject ,int ){var _be _cg .PdfObject ;_cbb :=-1;for _aff ,_baa :=range _ggb .Elements (){_be =_baa .DirectObject ;_cbb =_aff ;if _be !=nil {break ;};};return _be ,_cbb ;};

// Redactor represents a Redactor object.
type Redactor struct{_caac *_dc .PdfReader ;_adce *RedactionOptions ;_dgf *_eb .Creator ;_dcb *RectangleProps ;};

// RedactionOptions is a collection of RedactionTerm objects.
type RedactionOptions struct{Terms []RedactionTerm ;};type targetMap struct{_ddgb string ;_dfge [][]int ;};

// RedactRectanglePropsNew return a new pointer to a default RectangleProps object.
func RedactRectanglePropsNew ()*RectangleProps {return &RectangleProps {FillColor :_eb .ColorBlack ,BorderWidth :0.0,FillOpacity :1.0};};

// Redact executes the redact operation on a pdf file and updates the content streams of all pages of the file.
func (_gbdc *Redactor )Redact ()error {_acfb ,_beaf :=_gbdc ._caac .GetNumPages ();if _beaf !=nil {return _a .Errorf ("\u0066\u0061\u0069\u006c\u0065\u0064 \u0074\u006f\u0020\u0067\u0065\u0074\u0020\u0074\u0068\u0065\u0020\u006e\u0075m\u0062\u0065\u0072\u0020\u006f\u0066\u0020P\u0061\u0067\u0065\u0073");
};_afa :=_gbdc ._dcb .FillColor ;_afdf :=_gbdc ._dcb .BorderWidth ;_gcb :=_gbdc ._dcb .FillOpacity ;for _bead :=1;_bead <=_acfb ;_bead ++{_dad ,_dde :=_gbdc ._caac .GetPage (_bead );if _dde !=nil {return _dde ;};_aad ,_dde :=_fd .New (_dad );if _dde !=nil {return _dde ;
};_ggg ,_ ,_ ,_dde :=_aad .ExtractPageText ();if _dde !=nil {return _dde ;};_age :=_ggg .GetContentStreamOps ();_facb ,_degbe ,_dde :=_gbdc .redactPage (_age ,_dad .Resources );if _degbe ==nil {_b .Log .Info ("N\u006f\u0020\u006d\u0061\u0074\u0063\u0068\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0066\u006f\u0072\u0020t\u0068\u0065\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065d \u0070\u0061\u0074t\u0061r\u006e\u002e");
_degbe =_age ;};_dad .SetContentStreams ([]string {_degbe .String ()},_cg .NewFlateEncoder ());if _dde !=nil {return _dde ;};_ggef ,_dde :=_dad .GetMediaBox ();if _dde !=nil {return _dde ;};if _dad .MediaBox ==nil {_dad .MediaBox =_ggef ;};if _ceac :=_gbdc ._dgf .AddPage (_dad );
_ceac !=nil {return _ceac ;};_bec :=_ggef .Ury ;for _ ,_fega :=range _facb {_cdd :=_fega ._efe ;_gea :=_gbdc ._dgf .NewRectangle (_cdd .Llx ,_bec -_cdd .Lly ,_cdd .Urx -_cdd .Llx ,-(_cdd .Ury -_cdd .Lly ));_gea .SetFillColor (_afa );_gea .SetBorderWidth (_afdf );
_gea .SetFillOpacity (_gcb );if _dda :=_gbdc ._dgf .Draw (_gea );_dda !=nil {return nil ;};};};_gbdc ._dgf .SetOutlineTree (_gbdc ._caac .GetOutlineTree ());return nil ;};func _gaed (_fdeg *_gfd .ContentStreamOperations ,PdfObj _cg .PdfObject )(*_gfd .ContentStreamOperation ,int ,bool ){for _degd ,_bge :=range *_fdeg {_afga :=_bge .Operand ;
if _afga =="\u0054\u006a"{_acfa :=_cg .TraceToDirectObject (_bge .Params [0]);if _acfa ==PdfObj {return _bge ,_degd ,true ;};}else if _afga =="\u0054\u004a"{_gec ,_dfeb :=_cg .GetArray (_bge .Params [0]);if !_dfeb {return nil ,_degd ,_dfeb ;};for _ ,_degb :=range _gec .Elements (){if _degb ==PdfObj {return _bge ,_degd ,true ;
};};}else if _afga =="\u0022"{_abg :=_cg .TraceToDirectObject (_bge .Params [2]);if _abg ==PdfObj {return _bge ,_degd ,true ;};}else if _afga =="\u0027"{_bbfa :=_cg .TraceToDirectObject (_bge .Params [0]);if _bbfa ==PdfObj {return _bge ,_degd ,true ;};
};};return nil ,-1,false ;};func _ce (_feb string ,_gad *_dc .PdfFont )[]byte {_ecd ,_ca :=_gad .StringToCharcodeBytes (_feb );if _ca !=0{_b .Log .Debug ("\u0057\u0041\u0052\u004e\u003a\u0020\u0073\u006fm\u0065\u0020\u0072un\u0065\u0073\u0020\u0063\u006f\u0075l\u0064\u0020\u006e\u006f\u0074\u0020\u0062\u0065\u0020\u0065\u006e\u0063\u006f\u0064\u0065d\u002e\u000a\u0009\u0025\u0073\u0020\u002d\u003e \u0025\u0076",_feb ,_ecd );
};return _ecd ;};func _geb (_acc *_fd .TextMarkArray )*_dc .PdfFont {_ ,_fgc :=_gb (_acc );_fge :=_acc .Elements ()[_fgc ];_fbb :=_fge .Font ;return _fbb ;};func _ebed (_fcabb []*matchedIndex )[]*targetMap {_bbb :=make (map[string ][][]int );_cdgg :=[]*targetMap {};
for _ ,_fdac :=range _fcabb {_gdbgf :=_fdac ._dbbg ;_dddc :=[]int {_fdac ._bbfe ,_fdac ._cgg };if _gfaa ,_afaa :=_bbb [_gdbgf ];_afaa {_bbb [_gdbgf ]=append (_gfaa ,_dddc );}else {_bbb [_gdbgf ]=[][]int {_dddc };};};for _ebgb ,_faff :=range _bbb {_agc :=&targetMap {_ddgb :_ebgb ,_dfge :_faff };
_cdgg =append (_cdgg ,_agc );};return _cdgg ;};func _eaac (_gcbb RedactionTerm )(*regexMatcher ,error ){return &regexMatcher {_bcfc :_gcbb },nil };

// RedactionTerm holds the regexp pattern and the replacement string for the redaction process.
type RedactionTerm struct{Pattern *_gf .Regexp ;};func _bcd (_bff *_dc .PdfFont ,_cdg _fd .TextMark )float64 {_aabd :=0.001;_acf :=_cdg .Th /100;if _bff .Subtype ()=="\u0054\u0079\u0070e\u0033"{_aabd =1;};_fgd ,_aef :=_bff .GetRuneMetrics (' ');if !_aef {_fgd ,_aef =_bff .GetCharMetrics (32);
};if !_aef {_fgd ,_ =_dc .DefaultFont ().GetRuneMetrics (' ');};_ebb :=_aabd *((_fgd .Wx *_cdg .FontSize +_cdg .Tc +_cdg .Tw )/_acf );return _ebb ;};func _fg (_edd *_fd .TextMarkArray )int {_gc :=0;_bb :=_edd .Elements ();if _bb [0].Text =="\u0020"{_gc ++;
};if _bb [_edd .Len ()-1].Text =="\u0020"{_gc ++;};return _gc ;};func _beb (_ggee ,_ada string )[]int {if len (_ada )==0{return nil ;};var _gdg []int ;for _fbc :=0;_fbc < len (_ggee );{_gdbg :=_f .Index (_ggee [_fbc :],_ada );if _gdbg < 0{return _gdg ;
};_gdg =append (_gdg ,_fbc +_gdbg );_fbc +=_gdbg +len (_ada );};return _gdg ;};func _feg (_fca *_fd .TextMarkArray )string {_bffb :="";for _ ,_eeef :=range _fca .Elements (){_bffb +=_eeef .Text ;};return _bffb ;};type regexMatcher struct{_bcfc RedactionTerm };
func _fee (_gab *targetMap ,_abf []int ){var _faef [][]int ;for _bgcd ,_egga :=range _gab ._dfge {if _cbbc (_bgcd ,_abf ){continue ;};_faef =append (_faef ,_egga );};_gab ._dfge =_faef ;};

// Write writes the content of `re.creator` to writer of type io.Writer interface.
func (_abeb *Redactor )Write (writer _e .Writer )error {return _abeb ._dgf .Write (writer )};func (_daecg *regexMatcher )match (_ggaf string )([]*matchedIndex ,error ){_bca :=_daecg ._bcfc .Pattern ;if _bca ==nil {return nil ,_c .New ("\u006e\u006f\u0020\u0070at\u0074\u0065\u0072\u006e\u0020\u0063\u006f\u006d\u0070\u0069\u006c\u0065\u0064");
};var (_ebfd =_bca .FindAllStringIndex (_ggaf ,-1);_bda []*matchedIndex ;);for _ ,_bdba :=range _ebfd {_bda =append (_bda ,&matchedIndex {_bbfe :_bdba [0],_cgg :_bdba [1],_dbbg :_ggaf [_bdba [0]:_bdba [1]]});};return _bda ,nil ;};

// RectangleProps defines properties of the redaction rectangle to be drawn.
type RectangleProps struct{FillColor _eb .Color ;BorderWidth float64 ;FillOpacity float64 ;};func _caa (_gdbd string ,_fgdg []replacement ,_efc *_dc .PdfFont )[]_cg .PdfObject {_abb :=[]_cg .PdfObject {};_gccd :=0;_dbc :=_gdbd ;for _cdbc ,_fae :=range _fgdg {_afb :=_fae ._ebc ;
_gaff :=_fae ._cd ;_ecb :=_fae ._ee ;_gga :=_cg .MakeFloat (_gaff );if _gccd > _afb ||_afb ==-1{continue ;};_afge :=_gdbd [_gccd :_afb ];_fea :=_ce (_afge ,_efc );_cfb :=_cg .MakeStringFromBytes (_fea );_abb =append (_abb ,_cfb );_abb =append (_abb ,_gga );
_abbe :=_afb +len (_ecb );_dbc =_gdbd [_abbe :];_gccd =_abbe ;if _cdbc ==len (_fgdg )-1{_fea =_ce (_dbc ,_efc );_cfb =_cg .MakeStringFromBytes (_fea );_abb =append (_abb ,_cfb );};};return _abb ;};func _cgaa (_gag *_fd .TextMarkArray )[]*_fd .TextMarkArray {_fbce :=_gag .Elements ();
_ffcb :=len (_fbce );var _eef _cg .PdfObject ;_eaad :=[]*_fd .TextMarkArray {};_affa :=&_fd .TextMarkArray {};_gbb :=-1;for _ege ,_fad :=range _fbce {_gff :=_fad .DirectObject ;_gbb =_fad .Index ;if _gff ==nil {_caef :=_bcba (_gag ,_ege ,_gbb );if _eef !=nil {if _caef ==-1||_caef > _ege {_eaad =append (_eaad ,_affa );
_affa =&_fd .TextMarkArray {};};};}else if _gff !=nil &&_eef ==nil {if _gbb ==0&&_ege > 0{_eaad =append (_eaad ,_affa );_affa =&_fd .TextMarkArray {};};}else if _gff !=nil &&_eef !=nil {if _gff !=_eef {_eaad =append (_eaad ,_affa );_affa =&_fd .TextMarkArray {};
};};_eef =_gff ;_affa .Append (_fad );if _ege ==(_ffcb -1){_eaad =append (_eaad ,_affa );};};return _eaad ;};type matchedIndex struct{_bbfe int ;_cgg int ;_dbbg string ;};func _da (_bbg *_gfd .ContentStreamOperation ,_bg _cg .PdfObject ,_eg []localSpanMarks )error {_gfdcd ,_bcc :=_cg .GetArray (_bbg .Params [0]);
_ga :=[]_cg .PdfObject {};if !_bcc {_b .Log .Debug ("\u0045\u0052\u0052OR\u003a\u0020\u0054\u004a\u0020\u006f\u0070\u003d\u0025s\u0020G\u0065t\u0041r\u0072\u0061\u0079\u0056\u0061\u006c\u0020\u0066\u0061\u0069\u006c\u0065\u0064",_bbg );return _a .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_bbg );
};_fb ,_ab :=_cde (_eg );if len (_ab )==1{_dcf :=_ab [0];_cf :=_fb [_dcf ];if len (_cf )==1{_dae :=_cf [0];_ebf :=_dae ._fagb ;_gbe :=_geb (_ebf );_fdg ,_bbf :=_faf (_bg ,_gbe );if _bbf !=nil {return _bbf ;};_cbe ,_bbf :=_bab (_dae ,_ebf ,_gbe ,_fdg ,_dcf );
if _bbf !=nil {return _bbf ;};for _ ,_fa :=range _gfdcd .Elements (){if _fa ==_bg {_ga =append (_ga ,_cbe ...);}else {_ga =append (_ga ,_fa );};};}else {_cc :=_cf [0]._fagb ;_ge :=_geb (_cc );_dd ,_ffb :=_faf (_bg ,_ge );if _ffb !=nil {return _ffb ;};_dag ,_ffb :=_abe (_dd ,_cf );
if _ffb !=nil {return _ffb ;};_afg :=_bfbe (_dag );_cfa :=_caa (_dd ,_afg ,_ge );for _ ,_faa :=range _gfdcd .Elements (){if _faa ==_bg {_ga =append (_ga ,_cfa ...);}else {_ga =append (_ga ,_faa );};};};_bbg .Params [0]=_cg .MakeArray (_ga ...);}else if len (_ab )> 1{_aae :=_eg [0];
_ecg :=_aae ._fagb ;_ ,_fe :=_gb (_ecg );_db :=_ecg .Elements ()[_fe ];_ag :=_db .Font ;_bad ,_dbd :=_faf (_bg ,_ag );if _dbd !=nil {return _dbd ;};_dcfb ,_dbd :=_abe (_bad ,_eg );if _dbd !=nil {return _dbd ;};_ccd :=_bfbe (_dcfb );_ae :=_caa (_bad ,_ccd ,_ag );
for _ ,_ccc :=range _gfdcd .Elements (){if _ccc ==_bg {_ga =append (_ga ,_ae ...);}else {_ga =append (_ga ,_ccc );};};_bbg .Params [0]=_cg .MakeArray (_ga ...);};return nil ;};type replacement struct{_ee string ;_cd float64 ;_ebc int ;};func _fbbe (_dg *_gfd .ContentStreamOperation ,_edg _cg .PdfObject ,_ffe []localSpanMarks )error {var _de *_cg .PdfObjectArray ;
_ffee ,_fbe :=_cde (_ffe );if len (_fbe )==1{_eeag :=_fbe [0];_ad :=_ffee [_eeag ];if len (_ad )==1{_ced :=_ad [0];_bcb :=_ced ._fagb ;_efa :=_geb (_bcb );_bga ,_bcf :=_faf (_edg ,_efa );if _bcf !=nil {return _bcf ;};_ddb ,_bcf :=_bab (_ced ,_bcb ,_efa ,_bga ,_eeag );
if _bcf !=nil {return _bcf ;};_de =_cg .MakeArray (_ddb ...);}else {_deg :=_ad [0]._fagb ;_gae :=_geb (_deg );_gaf ,_dbe :=_faf (_edg ,_gae );if _dbe !=nil {return _dbe ;};_cef ,_dbe :=_abe (_gaf ,_ad );if _dbe !=nil {return _dbe ;};_gba :=_bfbe (_cef );
_ead :=_caa (_gaf ,_gba ,_gae );_de =_cg .MakeArray (_ead ...);};}else if len (_fbe )> 1{_gcc :=_ffe [0];_fbed :=_gcc ._fagb ;_ ,_dcd :=_gb (_fbed );_gcg :=_fbed .Elements ()[_dcd ];_aaf :=_gcg .Font ;_fdf ,_cdb :=_faf (_edg ,_aaf );if _cdb !=nil {return _cdb ;
};_bgc ,_cdb :=_abe (_fdf ,_ffe );if _cdb !=nil {return _cdb ;};_ebg :=_bfbe (_bgc );_geg :=_caa (_fdf ,_ebg ,_aaf );_de =_cg .MakeArray (_geg ...);};_dg .Params [0]=_de ;_dg .Operand ="\u0054\u004a";return nil ;};func _ddgg (_ega *_fd .TextMarkArray )(float64 ,error ){_ffbc ,_eaee :=_ega .BBox ();
if !_eaee {return 0.0,_a .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_ega );
};_fag :=_fg (_ega );_fac :=0.0;_ ,_abbee :=_gb (_ega );_aec :=_ega .Elements ()[_abbee ];_aac :=_aec .Font ;if _fag > 0{_fac =_bcd (_aac ,_aec );};_fab :=(_ffbc .Urx -_ffbc .Llx );_fab =_fab +_fac *float64 (_fag );Tj :=_dcg (_fab ,_aec .FontSize ,_aec .Th );
return Tj ,nil ;};func _caae (_bfa []*targetMap ){for _agd ,_fda :=range _bfa {for _cddd ,_edf :=range _bfa {if _agd !=_cddd {_dcgg ,_cff :=_gfg (*_fda ,*_edf );if _dcgg {_fee (_edf ,_cff );};};};};};func _ea (_eee *_gfd .ContentStreamOperations ,_af string ,_aab int )error {_ba :=_gfd .ContentStreamOperations {};
var _ed _gfd .ContentStreamOperation ;for _gdb ,_cb :=range *_eee {if _gdb ==_aab {if _af =="\u0027"{_cbg :=_gfd .ContentStreamOperation {Operand :"\u0054\u002a"};_ba =append (_ba ,&_cbg );_ed .Params =_cb .Params ;_ed .Operand ="\u0054\u006a";_ba =append (_ba ,&_ed );
}else if _af =="\u0022"{_ff :=_cb .Params [:2];Tc ,Tw :=_ff [0],_ff [1];_efg :=_gfd .ContentStreamOperation {Params :[]_cg .PdfObject {Tc },Operand :"\u0054\u0063"};_ba =append (_ba ,&_efg );_efg =_gfd .ContentStreamOperation {Params :[]_cg .PdfObject {Tw },Operand :"\u0054\u0077"};
_ba =append (_ba ,&_efg );_ed .Params =[]_cg .PdfObject {_cb .Params [2]};_ed .Operand ="\u0054\u006a";_ba =append (_ba ,&_ed );};};_ba =append (_ba ,_cb );};*_eee =_ba ;return nil ;};func _ffg (_aba []int ,_eebf *_fd .TextMarkArray ,_cfe string )(*_fd .TextMarkArray ,matchedBBox ,error ){_egb :=matchedBBox {};
_dbbc :=_aba [0];_cgee :=_aba [1];_agdb :=len (_cfe )-len (_f .TrimLeft (_cfe ,"\u0020"));_dege :=len (_cfe )-len (_f .TrimRight (_cfe ,"\u0020\u000a"));_dbbc =_dbbc +_agdb ;_cgee =_cgee -_dege ;_cfe =_f .Trim (_cfe ,"\u0020\u000a");_bdb ,_fed :=_eebf .RangeOffset (_dbbc ,_cgee );
if _fed !=nil {return nil ,_egb ,_fed ;};_dccd ,_dec :=_bdb .BBox ();if !_dec {return nil ,_egb ,_a .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_bdb );
};_egb =matchedBBox {_afgef :_cfe ,_efe :_dccd };return _bdb ,_egb ,nil ;};type matchedBBox struct{_efe _dc .PdfRectangle ;_afgef string ;};func _gfdb (_aa *_gfd .ContentStreamOperations ,_gd map[_cg .PdfObject ][]localSpanMarks )error {for _aag ,_ac :=range _gd {if _aag ==nil {continue ;
};_gfdc ,_gfc ,_ef :=_gaed (_aa ,_aag );if !_ef {_b .Log .Debug ("Pd\u0066\u004fb\u006a\u0065\u0063\u0074\u0020\u0025\u0073\u006e\u006ft\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0069\u006e\u0020\u0073\u0069\u0064\u0065\u0020\u0074\u0068\u0065\u0020\u0063\u006f\u006e\u0074\u0065\u006e\u0074\u0073\u0074r\u0065a\u006d\u0020\u006f\u0070\u0065\u0072\u0061\u0074i\u006fn\u0020\u0025s",_aag ,_aa );
return nil ;};if _gfdc .Operand =="\u0054\u006a"{_gg :=_fbbe (_gfdc ,_aag ,_ac );if _gg !=nil {return _gg ;};}else if _gfdc .Operand =="\u0054\u004a"{_eea :=_da (_gfdc ,_aag ,_ac );if _eea !=nil {return _eea ;};}else if _gfdc .Operand =="\u0027"||_gfdc .Operand =="\u0022"{_df :=_ea (_aa ,_gfdc .Operand ,_gfc );
if _df !=nil {return _df ;};_df =_fbbe (_gfdc ,_aag ,_ac );if _df !=nil {return _df ;};};};return nil ;};func _faf (_fcf _cg .PdfObject ,_gfcc *_dc .PdfFont )(string ,error ){_dbge ,_abd :=_cg .GetStringBytes (_fcf );if !_abd {return "",_cg .ErrTypeError ;
};_baf :=_gfcc .BytesToCharcodes (_dbge );_fcc ,_dge ,_efcc :=_gfcc .CharcodesToStrings (_baf );if _efcc > 0{_b .Log .Debug ("\u0072\u0065nd\u0065\u0072\u0054e\u0078\u0074\u003a\u0020num\u0043ha\u0072\u0073\u003d\u0025\u0064\u0020\u006eum\u004d\u0069\u0073\u0073\u0065\u0073\u003d%\u0064",_dge ,_efcc );
};_ceg :=_f .Join (_fcc ,"");return _ceg ,nil ;};func _cde (_eeb []localSpanMarks )(map[string ][]localSpanMarks ,[]string ){_cea :=make (map[string ][]localSpanMarks );_bfc :=[]string {};for _ ,_fef :=range _eeb {_fc :=_fef ._bgcf ;if _edc ,_ebd :=_cea [_fc ];
_ebd {_cea [_fc ]=append (_edc ,_fef );}else {_cea [_fc ]=[]localSpanMarks {_fef };_bfc =append (_bfc ,_fc );};};return _cea ,_bfc ;};func _bcba (_daec *_fd .TextMarkArray ,_acce int ,_eca int )int {_bed :=_daec .Elements ();_bbd :=_acce -1;_eage :=_acce +1;
_dfgc :=-1;if _bbd >=0{_fcef :=_bed [_bbd ];_cec :=_fcef .ObjString ;_ebcbd :=len (_cec );_dadg :=_fcef .Index ;if _dadg +1< _ebcbd {_dfgc =_bbd ;return _dfgc ;};};if _eage < len (_bed ){_bac :=_bed [_eage ];_cbbd :=_bac .ObjString ;if _cbbd [0]!=_bac .Text {_dfgc =_eage ;
return _dfgc ;};};return _dfgc ;};

// WriteToFile writes the redacted document to file specified by `outputPath`.
func (_dead *Redactor )WriteToFile (outputPath string )error {if _acfc :=_dead ._dgf .WriteToFile (outputPath );_acfc !=nil {return _a .Errorf ("\u0066\u0061\u0069l\u0065\u0064\u0020\u0074o\u0020\u0077\u0072\u0069\u0074\u0065\u0020t\u0068\u0065\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0066\u0069\u006c\u0065");
};return nil ;};type placeHolders struct{_bc []int ;_ec string ;_bce float64 ;};func _dcg (_egaa ,_cce ,_ebfg float64 )float64 {_ebfg =_ebfg /100;_cge :=(-1000*_egaa )/(_cce *_ebfg );return _cge ;};

// New instantiates a Redactor object with given PdfReader and `regex` pattern.
func New (reader *_dc .PdfReader ,opts *RedactionOptions ,rectProps *RectangleProps )*Redactor {if rectProps ==nil {rectProps =RedactRectanglePropsNew ();};return &Redactor {_caac :reader ,_adce :opts ,_dgf :_eb .New (),_dcb :rectProps };};func _bfbe (_dea []placeHolders )[]replacement {_ffc :=[]replacement {};
for _ ,_fde :=range _dea {_fgb :=_fde ._bc ;_fbf :=_fde ._ec ;_fdd :=_fde ._bce ;for _ ,_dee :=range _fgb {_adc :=replacement {_ee :_fbf ,_cd :_fdd ,_ebc :_dee };_ffc =append (_ffc ,_adc );};};_d .Slice (_ffc ,func (_afd ,_ebe int )bool {return _ffc [_afd ]._ebc < _ffc [_ebe ]._ebc });
return _ffc ;};func (_deac *Redactor )redactPage (_cbf *_gfd .ContentStreamOperations ,_ddd *_dc .PdfPageResources )([]matchedBBox ,*_gfd .ContentStreamOperations ,error ){_deb ,_ggd :=_fd .NewFromContents (_cbf .String (),_ddd );if _ggd !=nil {return nil ,nil ,_ggd ;
};_dcce ,_ ,_ ,_ggd :=_deb .ExtractPageText ();if _ggd !=nil {return nil ,nil ,_ggd ;};_cbf =_dcce .GetContentStreamOps ();_caf :=_dcce .Marks ();_cee :=_dcce .Text ();_gdf :=[]matchedBBox {};_cgd :=make (map[_cg .PdfObject ][]localSpanMarks );_gfa :=[]*targetMap {};
for _ ,_badg :=range _deac ._adce .Terms {_ebcb ,_eebd :=_eaac (_badg );if _eebd !=nil {return nil ,nil ,_eebd ;};_agf ,_eebd :=_ebcb .match (_cee );if _eebd !=nil {return nil ,nil ,_eebd ;};_bdf :=_ebed (_agf );_gfa =append (_gfa ,_bdf ...);};_caae (_gfa );
for _ ,_fcab :=range _gfa {_bdfa :=_fcab ._ddgb ;_bbfd :=_fcab ._dfge ;_bafe :=[]matchedBBox {};for _ ,_cga :=range _bbfd {_efd ,_ggc ,_bde :=_ffg (_cga ,_caf ,_bdfa );if _bde !=nil {return nil ,nil ,_bde ;};_geaa :=_cgaa (_efd );for _gafa ,_ded :=range _geaa {_gaee :=localSpanMarks {_fagb :_ded ,_gce :_gafa ,_bgcf :_bdfa };
_ffef ,_ :=_gb (_ded );if _gaffc ,_bbe :=_cgd [_ffef ];_bbe {_cgd [_ffef ]=append (_gaffc ,_gaee );}else {_cgd [_ffef ]=[]localSpanMarks {_gaee };};};_bafe =append (_bafe ,_ggc );};_gdf =append (_gdf ,_bafe ...);};_ggd =_gfdb (_cbf ,_cgd );if _ggd !=nil {return nil ,nil ,_ggd ;
};return _gdf ,_cbf ,nil ;};