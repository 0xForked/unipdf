//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package redactor ;import (_c "errors";_g "fmt";_dc "github.com/unidoc/unipdf/v3/common";_gd "github.com/unidoc/unipdf/v3/contentstream";_a "github.com/unidoc/unipdf/v3/core";_gf "github.com/unidoc/unipdf/v3/creator";_fe "github.com/unidoc/unipdf/v3/extractor";
_bd "github.com/unidoc/unipdf/v3/model";_fa "io";_f "regexp";_de "sort";_b "strings";);func _ceef (_acff []*matchedIndex )[]*targetMap {_efbc :=make (map[string ][][]int );_fdgd :=[]*targetMap {};for _ ,_eac :=range _acff {_aba :=_eac ._afbg ;_dbdc :=[]int {_eac ._agb ,_eac ._ddf };
if _cbcg ,_fgb :=_efbc [_aba ];_fgb {_efbc [_aba ]=append (_cbcg ,_dbdc );}else {_efbc [_aba ]=[][]int {_dbdc };};};for _ade ,_babe :=range _efbc {_fec :=&targetMap {_bfa :_ade ,_gdc :_babe };_fdgd =append (_fdgd ,_fec );};return _fdgd ;};

// RedactRectanglePropsNew return a new pointer to a default RectangleProps object.
func RedactRectanglePropsNew ()*RectangleProps {return &RectangleProps {FillColor :_gf .ColorBlack ,BorderWidth :0.0,FillOpacity :1.0};};func _aggf (_fga string ,_cgfg []localSpanMarks )([]placeHolders ,error ){_edf :="";_afb :=[]placeHolders {};for _gbd ,_aed :=range _cgfg {_afdc :=_aed ._aee ;
_gba :=_aed ._gfb ;_caf :=_faa (_afdc );_dec ,_efb :=_edc (_afdc );if _efb !=nil {return nil ,_efb ;};if _caf !=_edf {var _dfg []int ;if _gbd ==0&&_gba !=_caf {_dde :=_b .Index (_fga ,_caf );_dfg =[]int {_dde };}else if _gbd ==len (_cgfg )-1{_ced :=_b .LastIndex (_fga ,_caf );
_dfg =[]int {_ced };}else {_dfg =_dcad (_fga ,_caf );};_efe :=placeHolders {_aa :_dfg ,_gb :_caf ,_fab :_dec };_afb =append (_afb ,_efe );};_edf =_caf ;};return _afb ,nil ;};func _edc (_gcbe *_fe .TextMarkArray )(float64 ,error ){_bfe ,_cge :=_gcbe .BBox ();
if !_cge {return 0.0,_g .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_gcbe );
};_fdb :=_cgb (_gcbe );_gdf :=0.0;_ ,_fgf :=_eee (_gcbe );_caff :=_gcbe .Elements ()[_fgf ];_ace :=_caff .Font ;if _fdb > 0{_gdf =_egd (_ace ,_caff );};_gfe :=(_bfe .Urx -_bfe .Llx );_gfe =_gfe +_gdf *float64 (_fdb );Tj :=_efa (_gfe ,_caff .FontSize ,_caff .Th );
return Tj ,nil ;};

// RedactionOptions is a collection of RedactionTerm objects.
type RedactionOptions struct{Terms []RedactionTerm ;};

// Redact executes the redact operation on a pdf file and updates the content streams of all pages of the file.
func (_egdb *Redactor )Redact ()error {_dda ,_efba :=_egdb ._cfed .GetNumPages ();if _efba !=nil {return _g .Errorf ("\u0066\u0061\u0069\u006c\u0065\u0064 \u0074\u006f\u0020\u0067\u0065\u0074\u0020\u0074\u0068\u0065\u0020\u006e\u0075m\u0062\u0065\u0072\u0020\u006f\u0066\u0020P\u0061\u0067\u0065\u0073");
};_gbdf :=_egdb ._bedf .FillColor ;_eaf :=_egdb ._bedf .BorderWidth ;_dcd :=_egdb ._bedf .FillOpacity ;for _cda :=1;_cda <=_dda ;_cda ++{_fcg ,_afcb :=_egdb ._cfed .GetPage (_cda );if _afcb !=nil {return _afcb ;};_dgfe ,_afcb :=_fe .New (_fcg );if _afcb !=nil {return _afcb ;
};_adgcg ,_ ,_ ,_afcb :=_dgfe .ExtractPageText ();if _afcb !=nil {return _afcb ;};_gcc :=_adgcg .GetContentStreamOps ();_cecf ,_ceb ,_afcb :=_egdb .redactPage (_gcc ,_fcg .Resources );if _ceb ==nil {_dc .Log .Info ("N\u006f\u0020\u006d\u0061\u0074\u0063\u0068\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0066\u006f\u0072\u0020t\u0068\u0065\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065d \u0070\u0061\u0074t\u0061r\u006e\u002e");
_ceb =_gcc ;};_fcg .SetContentStreams ([]string {_ceb .String ()},_a .NewFlateEncoder ());if _afcb !=nil {return _afcb ;};_gbad ,_afcb :=_fcg .GetMediaBox ();if _afcb !=nil {return _afcb ;};if _fcg .MediaBox ==nil {_fcg .MediaBox =_gbad ;};if _fbf :=_egdb ._cfdb .AddPage (_fcg );
_fbf !=nil {return _fbf ;};_cac :=_gbad .Ury ;for _ ,_dgdg :=range _cecf {_dbf :=_dgdg ._aedc ;_ddd :=_egdb ._cfdb .NewRectangle (_dbf .Llx ,_cac -_dbf .Lly ,_dbf .Urx -_dbf .Llx ,-(_dbf .Ury -_dbf .Lly ));_ddd .SetFillColor (_gbdf );_ddd .SetBorderWidth (_eaf );
_ddd .SetFillOpacity (_dcd );if _bddg :=_egdb ._cfdb .Draw (_ddd );_bddg !=nil {return nil ;};};};_egdb ._cfdb .SetOutlineTree (_egdb ._cfed .GetOutlineTree ());return nil ;};func _ebff (_geg []placeHolders )[]replacement {_cag :=[]replacement {};for _ ,_acfa :=range _geg {_aegb :=_acfa ._aa ;
_afca :=_acfa ._gb ;_ege :=_acfa ._fab ;for _ ,_abc :=range _aegb {_eba :=replacement {_cc :_afca ,_e :_ege ,_ad :_abc };_cag =append (_cag ,_eba );};};_de .Slice (_cag ,func (_bga ,_cgae int )bool {return _cag [_bga ]._ad < _cag [_cgae ]._ad });return _cag ;
};func _bfed (_geaa *targetMap ,_fdgf []int ){var _deeb [][]int ;for _eea ,_gcag :=range _geaa ._gdc {if _ggfd (_eea ,_fdgf ){continue ;};_deeb =append (_deeb ,_gcag );};_geaa ._gdc =_deeb ;};func _eee (_acc *_fe .TextMarkArray )(_a .PdfObject ,int ){var _dgg _a .PdfObject ;
_feb :=-1;for _cgbd ,_ggc :=range _acc .Elements (){_dgg =_ggc .DirectObject ;_feb =_cgbd ;if _dgg !=nil {break ;};};return _dgg ,_feb ;};type replacement struct{_cc string ;_e float64 ;_ad int ;};func _dcad (_bcaf ,_cfea string )[]int {if len (_cfea )==0{return nil ;
};var _dbac []int ;for _gega :=0;_gega < len (_bcaf );{_cagf :=_b .Index (_bcaf [_gega :],_cfea );if _cagf < 0{return _dbac ;};_dbac =append (_dbac ,_gega +_cagf );_gega +=_cagf +len (_cfea );};return _dbac ;};func _dfce (_caa ,_geac targetMap )(bool ,[]int ){_gcd :=_b .Contains (_caa ._bfa ,_geac ._bfa );
var _bff []int ;for _ ,_cgge :=range _caa ._gdc {for _gef ,_afgf :=range _geac ._gdc {if _afgf [0]>=_cgge [0]&&_afgf [1]<=_cgge [1]{_bff =append (_bff ,_gef );};};};return _gcd ,_bff ;};type regexMatcher struct{_aff RedactionTerm };

// RectangleProps defines properties of the redaction rectangle to be drawn.
type RectangleProps struct{FillColor _gf .Color ;BorderWidth float64 ;FillOpacity float64 ;};

// RedactionTerm holds the regexp pattern and the replacement string for the redaction process.
type RedactionTerm struct{Pattern *_f .Regexp ;};type matchedIndex struct{_agb int ;_ddf int ;_afbg string ;};func _baa (_aga *_fe .TextMarkArray ,_eccb int ,_ged int )int {_aafc :=_aga .Elements ();_eff :=_eccb -1;_bgdg :=_eccb +1;_edd :=-1;if _eff >=0{_aaad :=_aafc [_eff ];
_abb :=_aaad .ObjString ;_aef :=len (_abb );_cfdg :=_aaad .Index ;if _cfdg +1< _aef {_edd =_eff ;return _edd ;};};if _bgdg < len (_aafc ){_eafg :=_aafc [_bgdg ];_dcca :=_eafg .ObjString ;if _dcca [0]!=_eafg .Text {_edd =_bgdg ;return _edd ;};};return _edd ;
};func _ggfd (_aace int ,_gcgf []int )bool {for _ ,_adbb :=range _gcgf {if _adbb ==_aace {return true ;};};return false ;};func _ggg (_agd string ,_bca []replacement ,_bed *_bd .PdfFont )[]_a .PdfObject {_afbb :=[]_a .PdfObject {};_gbb :=0;_ccf :=_agd ;
for _aca ,_cdd :=range _bca {_gdgg :=_cdd ._ad ;_dae :=_cdd ._e ;_dfga :=_cdd ._cc ;_dgf :=_a .MakeFloat (_dae );if _gbb > _gdgg ||_gdgg ==-1{continue ;};_bgd :=_agd [_gbb :_gdgg ];_cgc :=_gdg (_bgd ,_bed );_fef :=_a .MakeStringFromBytes (_cgc );_afbb =append (_afbb ,_fef );
_afbb =append (_afbb ,_dgf );_bdd :=_gdgg +len (_dfga );_ccf =_agd [_bdd :];_gbb =_bdd ;if _aca ==len (_bca )-1{_cgc =_gdg (_ccf ,_bed );_fef =_a .MakeStringFromBytes (_cgc );_afbb =append (_afbb ,_fef );};};return _afbb ;};func _gfce (_geag *_gd .ContentStreamOperations ,PdfObj _a .PdfObject )(*_gd .ContentStreamOperation ,int ,bool ){for _bgb ,_ggcc :=range *_geag {_ebb :=_ggcc .Operand ;
if _ebb =="\u0054\u006a"{_cee :=_a .TraceToDirectObject (_ggcc .Params [0]);if _cee ==PdfObj {return _ggcc ,_bgb ,true ;};}else if _ebb =="\u0054\u004a"{_fege ,_acd :=_a .GetArray (_ggcc .Params [0]);if !_acd {return nil ,_bgb ,_acd ;};for _ ,_accf :=range _fege .Elements (){if _accf ==PdfObj {return _ggcc ,_bgb ,true ;
};};}else if _ebb =="\u0022"{_eagg :=_a .TraceToDirectObject (_ggcc .Params [2]);if _eagg ==PdfObj {return _ggcc ,_bgb ,true ;};}else if _ebb =="\u0027"{_fgc :=_a .TraceToDirectObject (_ggcc .Params [0]);if _fgc ==PdfObj {return _ggcc ,_bgb ,true ;};};
};return nil ,-1,false ;};type matchedBBox struct{_aedc _bd .PdfRectangle ;_gfg string ;};func (_eede *regexMatcher )match (_efca string )([]*matchedIndex ,error ){_fee :=_eede ._aff .Pattern ;if _fee ==nil {return nil ,_c .New ("\u006e\u006f\u0020\u0070at\u0074\u0065\u0072\u006e\u0020\u0063\u006f\u006d\u0070\u0069\u006c\u0065\u0064");
};var (_bfag =_fee .FindAllStringIndex (_efca ,-1);_efbg []*matchedIndex ;);for _ ,_dccc :=range _bfag {_efbg =append (_efbg ,&matchedIndex {_agb :_dccc [0],_ddf :_dccc [1],_afbg :_efca [_dccc [0]:_dccc [1]]});};return _efbg ,nil ;};func _bbb (_afa *_fe .TextMarkArray )*_bd .PdfFont {_ ,_ed :=_eee (_afa );
_dbd :=_afa .Elements ()[_ed ];_aeg :=_dbd .Font ;return _aeg ;};type localSpanMarks struct{_aee *_fe .TextMarkArray ;_fcec int ;_gfb string ;};func _efa (_ffd ,_ffgg ,_bbgg float64 )float64 {_bbgg =_bbgg /100;_ffb :=(-1000*_ffd )/(_ffgg *_bbgg );return _ffb ;
};func _eb (_ec *_gd .ContentStreamOperations ,_feg map[_a .PdfObject ][]localSpanMarks )error {for _ac ,_fc :=range _feg {if _ac ==nil {continue ;};_bde ,_cf ,_fd :=_gfce (_ec ,_ac );if !_fd {_dc .Log .Debug ("Pd\u0066\u004fb\u006a\u0065\u0063\u0074\u0020\u0025\u0073\u006e\u006ft\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0069\u006e\u0020\u0073\u0069\u0064\u0065\u0020\u0074\u0068\u0065\u0020\u0063\u006f\u006e\u0074\u0065\u006e\u0074\u0073\u0074r\u0065a\u006d\u0020\u006f\u0070\u0065\u0072\u0061\u0074i\u006fn\u0020\u0025s",_ac ,_ec );
return nil ;};if _bde .Operand =="\u0054\u006a"{_bb :=_fb (_bde ,_ac ,_fc );if _bb !=nil {return _bb ;};}else if _bde .Operand =="\u0054\u004a"{_db :=_ge (_bde ,_ac ,_fc );if _db !=nil {return _db ;};}else if _bde .Operand =="\u0027"||_bde .Operand =="\u0022"{_cg :=_dg (_ec ,_bde .Operand ,_cf );
if _cg !=nil {return _cg ;};_cg =_fb (_bde ,_ac ,_fc );if _cg !=nil {return _cg ;};};};return nil ;};type placeHolders struct{_aa []int ;_gb string ;_fab float64 ;};func _ggcd (_dcb []int ,_acee *_fe .TextMarkArray ,_ceca string )(*_fe .TextMarkArray ,matchedBBox ,error ){_abefg :=matchedBBox {};
_dfae :=_dcb [0];_fbd :=_dcb [1];_fgcf :=len (_ceca )-len (_b .TrimLeft (_ceca ,"\u0020"));_ece :=len (_ceca )-len (_b .TrimRight (_ceca ,"\u0020\u000a"));_dfae =_dfae +_fgcf ;_fbd =_fbd -_ece ;_ceca =_b .Trim (_ceca ,"\u0020\u000a");_ada ,_afda :=_acee .RangeOffset (_dfae ,_fbd );
if _afda !=nil {return nil ,_abefg ,_afda ;};_afdb ,_adf :=_ada .BBox ();if !_adf {return nil ,_abefg ,_g .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_ada );
};_abefg =matchedBBox {_gfg :_ceca ,_aedc :_afdb };return _ada ,_abefg ,nil ;};func _egd (_dbc *_bd .PdfFont ,_ae _fe .TextMark )float64 {_fac :=0.001;_ggf :=_ae .Th /100;if _dbc .Subtype ()=="\u0054\u0079\u0070e\u0033"{_fac =1;};_gca ,_da :=_dbc .GetRuneMetrics (' ');
if !_da {_gca ,_da =_dbc .GetCharMetrics (32);};if !_da {_gca ,_ =_bd .DefaultFont ().GetRuneMetrics (' ');};_dba :=_fac *((_gca .Wx *_ae .FontSize +_ae .Tc +_ae .Tw )/_ggf );return _dba ;};func _faa (_fdg *_fe .TextMarkArray )string {_fddf :="";for _ ,_bbe :=range _fdg .Elements (){_fddf +=_bbe .Text ;
};return _fddf ;};func _cgf (_bf []localSpanMarks )(map[string ][]localSpanMarks ,[]string ){_acgd :=make (map[string ][]localSpanMarks );_daf :=[]string {};for _ ,_bc :=range _bf {_egf :=_bc ._gfb ;if _dac ,_gbf :=_acgd [_egf ];_gbf {_acgd [_egf ]=append (_dac ,_bc );
}else {_acgd [_egf ]=[]localSpanMarks {_bc };_daf =append (_daf ,_egf );};};return _acgd ,_daf ;};func _fbg (_fgg localSpanMarks ,_aag *_fe .TextMarkArray ,_ecb *_bd .PdfFont ,_ddb ,_bab string )([]_a .PdfObject ,error ){_eeeb :=_faa (_aag );Tj ,_dea :=_edc (_aag );
if _dea !=nil {return nil ,_dea ;};_cabg :=len (_ddb );_ebf :=len (_eeeb );_fbe :=-1;_dgdf :=_a .MakeFloat (Tj );if _eeeb !=_bab {_bad :=_fgg ._fcec ;if _bad ==0{_fbe =_b .LastIndex (_ddb ,_eeeb );}else {_fbe =_b .Index (_ddb ,_eeeb );};}else {_fbe =_b .Index (_ddb ,_eeeb );
};_acf :=_fbe +_ebf ;_bfba :=[]_a .PdfObject {};if _fbe ==0&&_acf ==_cabg {_bfba =append (_bfba ,_dgdf );}else if _fbe ==0&&_acf < _cabg {_cfd :=_gdg (_ddb [_acf :],_ecb );_ebd :=_a .MakeStringFromBytes (_cfd );_bfba =append (_bfba ,_dgdf ,_ebd );}else if _fbe > 0&&_acf >=_cabg {_fce :=_gdg (_ddb [:_fbe ],_ecb );
_bdf :=_a .MakeStringFromBytes (_fce );_bfba =append (_bfba ,_bdf ,_dgdf );}else if _fbe > 0&&_acf < _cabg {_afd :=_gdg (_ddb [:_fbe ],_ecb );_dggbc :=_gdg (_ddb [_acf :],_ecb );_eae :=_a .MakeStringFromBytes (_afd );_afc :=_a .MakeString (string (_dggbc ));
_bfba =append (_bfba ,_eae ,_dgdf ,_afc );};return _bfba ,nil ;};func _dg (_gg *_gd .ContentStreamOperations ,_ca string ,_cab int )error {_ee :=_gd .ContentStreamOperations {};var _fdf _gd .ContentStreamOperation ;for _dbb ,_bbg :=range *_gg {if _dbb ==_cab {if _ca =="\u0027"{_bg :=_gd .ContentStreamOperation {Operand :"\u0054\u002a"};
_ee =append (_ee ,&_bg );_fdf .Params =_bbg .Params ;_fdf .Operand ="\u0054\u006a";_ee =append (_ee ,&_fdf );}else if _ca =="\u0022"{_acb :=_bbg .Params [:2];Tc ,Tw :=_acb [0],_acb [1];_cd :=_gd .ContentStreamOperation {Params :[]_a .PdfObject {Tc },Operand :"\u0054\u0063"};
_ee =append (_ee ,&_cd );_cd =_gd .ContentStreamOperation {Params :[]_a .PdfObject {Tw },Operand :"\u0054\u0077"};_ee =append (_ee ,&_cd );_fdf .Params =[]_a .PdfObject {_bbg .Params [2]};_fdf .Operand ="\u0054\u006a";_ee =append (_ee ,&_fdf );};};_ee =append (_ee ,_bbg );
};*_gg =_ee ;return nil ;};func _egeb (_adba _a .PdfObject ,_gbe *_bd .PdfFont )(string ,error ){_cdf ,_bcc :=_a .GetStringBytes (_adba );if !_bcc {return "",_a .ErrTypeError ;};_egff :=_gbe .BytesToCharcodes (_cdf );_dee ,_dgdb ,_abef :=_gbe .CharcodesToStrings (_egff );
if _abef > 0{_dc .Log .Debug ("\u0072\u0065nd\u0065\u0072\u0054e\u0078\u0074\u003a\u0020num\u0043ha\u0072\u0073\u003d\u0025\u0064\u0020\u006eum\u004d\u0069\u0073\u0073\u0065\u0073\u003d%\u0064",_dgdb ,_abef );};_acfd :=_b .Join (_dee ,"");return _acfd ,nil ;
};

// Write writes the content of `re.creator` to writer of type io.Writer interface.
func (_cbc *Redactor )Write (writer _fa .Writer )error {return _cbc ._cfdb .Write (writer )};func _ggfg (_eeg []*targetMap ){for _cae ,_dfc :=range _eeg {for _ccb ,_cff :=range _eeg {if _cae !=_ccb {_dfgf ,_eec :=_dfce (*_dfc ,*_cff );if _dfgf {_bfed (_cff ,_eec );
};};};};};func _gdg (_aeb string ,_acg *_bd .PdfFont )[]byte {_fdfe ,_af :=_acg .StringToCharcodeBytes (_aeb );if _af !=0{_dc .Log .Debug ("\u0057\u0041\u0052\u004e\u003a\u0020\u0073\u006fm\u0065\u0020\u0072un\u0065\u0073\u0020\u0063\u006f\u0075l\u0064\u0020\u006e\u006f\u0074\u0020\u0062\u0065\u0020\u0065\u006e\u0063\u006f\u0064\u0065d\u002e\u000a\u0009\u0025\u0073\u0020\u002d\u003e \u0025\u0076",_aeb ,_fdfe );
};return _fdfe ;};func _ccg (_gbbe RedactionTerm )(*regexMatcher ,error ){return &regexMatcher {_aff :_gbbe },nil };func _fb (_adg *_gd .ContentStreamOperation ,_adb _a .PdfObject ,_aad []localSpanMarks )error {var _ggb *_a .PdfObjectArray ;_cgac ,_adgc :=_cgf (_aad );
if len (_adgc )==1{_fega :=_adgc [0];_cca :=_cgac [_fega ];if len (_cca )==1{_bacd :=_cca [0];_gcf :=_bacd ._aee ;_bbgd :=_bbb (_gcf );_adbf ,_agf :=_egeb (_adb ,_bbgd );if _agf !=nil {return _agf ;};_gcg ,_agf :=_fbg (_bacd ,_gcf ,_bbgd ,_adbf ,_fega );
if _agf !=nil {return _agf ;};_ggb =_a .MakeArray (_gcg ...);}else {_ea :=_cca [0]._aee ;_ead :=_bbb (_ea );_gbc ,_gfc :=_egeb (_adb ,_ead );if _gfc !=nil {return _gfc ;};_bacdg ,_gfc :=_aggf (_gbc ,_cca );if _gfc !=nil {return _gfc ;};_cgg :=_ebff (_bacdg );
_aac :=_ggg (_gbc ,_cgg ,_ead );_ggb =_a .MakeArray (_aac ...);};}else if len (_adgc )> 1{_dafb :=_aad [0];_cfe :=_dafb ._aee ;_ ,_ecfe :=_eee (_cfe );_ede :=_cfe .Elements ()[_ecfe ];_bdc :=_ede .Font ;_cfg ,_bfb :=_egeb (_adb ,_bdc );if _bfb !=nil {return _bfb ;
};_eag ,_bfb :=_aggf (_cfg ,_aad );if _bfb !=nil {return _bfb ;};_ff :=_ebff (_eag );_ffg :=_ggg (_cfg ,_ff ,_bdc );_ggb =_a .MakeArray (_ffg ...);};_adg .Params [0]=_ggb ;_adg .Operand ="\u0054\u004a";return nil ;};type targetMap struct{_bfa string ;_gdc [][]int ;
};

// New instantiates a Redactor object with given PdfReader and `regex` pattern.
func New (reader *_bd .PdfReader ,opts *RedactionOptions ,rectProps *RectangleProps )*Redactor {if rectProps ==nil {rectProps =RedactRectanglePropsNew ();};return &Redactor {_cfed :reader ,_gde :opts ,_cfdb :_gf .New (),_bedf :rectProps };};

// WriteToFile writes the redacted document to file specified by `outputPath`.
func (_eggf *Redactor )WriteToFile (outputPath string )error {if _aacb :=_eggf ._cfdb .WriteToFile (outputPath );_aacb !=nil {return _g .Errorf ("\u0066\u0061\u0069l\u0065\u0064\u0020\u0074o\u0020\u0077\u0072\u0069\u0074\u0065\u0020t\u0068\u0065\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0066\u0069\u006c\u0065");
};return nil ;};func _ge (_cga *_gd .ContentStreamOperation ,_ebe _a .PdfObject ,_fabd []localSpanMarks )error {_fdc ,_ecg :=_a .GetArray (_cga .Params [0]);_ef :=[]_a .PdfObject {};if !_ecg {_dc .Log .Debug ("\u0045\u0052\u0052OR\u003a\u0020\u0054\u004a\u0020\u006f\u0070\u003d\u0025s\u0020G\u0065t\u0041r\u0072\u0061\u0079\u0056\u0061\u006c\u0020\u0066\u0061\u0069\u006c\u0065\u0064",_cga );
return _g .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_cga );
};_dggg ,_fg :=_cgf (_fabd );if len (_fg )==1{_bbd :=_fg [0];_ag :=_dggg [_bbd ];if len (_ag )==1{_bgc :=_ag [0];_fed :=_bgc ._aee ;_ga :=_bbb (_fed );_adc ,_ba :=_egeb (_ebe ,_ga );if _ba !=nil {return _ba ;};_aaa ,_ba :=_fbg (_bgc ,_fed ,_ga ,_adc ,_bbd );
if _ba !=nil {return _ba ;};for _ ,_cdc :=range _fdc .Elements (){if _cdc ==_ebe {_ef =append (_ef ,_aaa ...);}else {_ef =append (_ef ,_cdc );};};}else {_ce :=_ag [0]._aee ;_cabd :=_bbb (_ce );_agg ,_gga :=_egeb (_ebe ,_cabd );if _gga !=nil {return _gga ;
};_gad ,_gga :=_aggf (_agg ,_ag );if _gga !=nil {return _gga ;};_bac :=_ebff (_gad );_bbc :=_ggg (_agg ,_bac ,_cabd );for _ ,_bbgb :=range _fdc .Elements (){if _bbgb ==_ebe {_ef =append (_ef ,_bbc ...);}else {_ef =append (_ef ,_bbgb );};};};_cga .Params [0]=_a .MakeArray (_ef ...);
}else if len (_fg )> 1{_cb :=_fabd [0];_cec :=_cb ._aee ;_ ,_gc :=_eee (_cec );_dca :=_cec .Elements ()[_gc ];_cdcb :=_dca .Font ;_eg ,_dggb :=_egeb (_ebe ,_cdcb );if _dggb !=nil {return _dggb ;};_abe ,_dggb :=_aggf (_eg ,_fabd );if _dggb !=nil {return _dggb ;
};_gea :=_ebff (_abe );_be :=_ggg (_eg ,_gea ,_cdcb );for _ ,_gge :=range _fdc .Elements (){if _gge ==_ebe {_ef =append (_ef ,_be ...);}else {_ef =append (_ef ,_gge );};};_cga .Params [0]=_a .MakeArray (_ef ...);};return nil ;};func _bcf (_edee *_fe .TextMarkArray )[]*_fe .TextMarkArray {_ggac :=_edee .Elements ();
_gbed :=len (_ggac );var _deb _a .PdfObject ;_dfe :=[]*_fe .TextMarkArray {};_aedb :=&_fe .TextMarkArray {};_cedc :=-1;for _bfdb ,_cfdbg :=range _ggac {_bbgc :=_cfdbg .DirectObject ;_cedc =_cfdbg .Index ;if _bbgc ==nil {_fegg :=_baa (_edee ,_bfdb ,_cedc );
if _deb !=nil {if _fegg ==-1||_fegg > _bfdb {_dfe =append (_dfe ,_aedb );_aedb =&_fe .TextMarkArray {};};};}else if _bbgc !=nil &&_deb ==nil {if _cedc ==0&&_bfdb > 0{_dfe =append (_dfe ,_aedb );_aedb =&_fe .TextMarkArray {};};}else if _bbgc !=nil &&_deb !=nil {if _bbgc !=_deb {_dfe =append (_dfe ,_aedb );
_aedb =&_fe .TextMarkArray {};};};_deb =_bbgc ;_aedb .Append (_cfdbg );if _bfdb ==(_gbed -1){_dfe =append (_dfe ,_aedb );};};return _dfe ;};func (_dgb *Redactor )redactPage (_ecc *_gd .ContentStreamOperations ,_gfec *_bd .PdfPageResources )([]matchedBBox ,*_gd .ContentStreamOperations ,error ){_gda ,_egg :=_fe .NewFromContents (_ecc .String (),_gfec );
if _egg !=nil {return nil ,nil ,_egg ;};_bdda ,_ ,_ ,_egg :=_gda .ExtractPageText ();if _egg !=nil {return nil ,nil ,_egg ;};_ecc =_bdda .GetContentStreamOps ();_ddg :=_bdda .Marks ();_aea :=_bdda .Text ();_gec :=[]matchedBBox {};_aede :=make (map[_a .PdfObject ][]localSpanMarks );
_bfg :=[]*targetMap {};for _ ,_fgd :=range _dgb ._gde .Terms {_deg ,_ddga :=_ccg (_fgd );if _ddga !=nil {return nil ,nil ,_ddga ;};_agfb ,_ddga :=_deg .match (_aea );if _ddga !=nil {return nil ,nil ,_ddga ;};_dgc :=_ceef (_agfb );_bfg =append (_bfg ,_dgc ...);
};_ggfg (_bfg );for _ ,_bec :=range _bfg {_dgge :=_bec ._bfa ;_gee :=_bec ._gdc ;_bbge :=[]matchedBBox {};for _ ,_dfa :=range _gee {_aae ,_aggb ,_ddgg :=_ggcd (_dfa ,_ddg ,_dgge );if _ddgg !=nil {return nil ,nil ,_ddgg ;};_adbg :=_bcf (_aae );for _dcc ,_bfd :=range _adbg {_abeb :=localSpanMarks {_aee :_bfd ,_fcec :_dcc ,_gfb :_dgge };
_eaed ,_ :=_eee (_bfd );if _cacb ,_beg :=_aede [_eaed ];_beg {_aede [_eaed ]=append (_cacb ,_abeb );}else {_aede [_eaed ]=[]localSpanMarks {_abeb };};};_bbge =append (_bbge ,_aggb );};_gec =append (_gec ,_bbge ...);};_egg =_eb (_ecc ,_aede );if _egg !=nil {return nil ,nil ,_egg ;
};return _gec ,_ecc ,nil ;};

// Redactor represents a Redactor object.
type Redactor struct{_cfed *_bd .PdfReader ;_gde *RedactionOptions ;_cfdb *_gf .Creator ;_bedf *RectangleProps ;};func _cgb (_eed *_fe .TextMarkArray )int {_dgd :=0;_ab :=_eed .Elements ();if _ab [0].Text =="\u0020"{_dgd ++;};if _ab [_eed .Len ()-1].Text =="\u0020"{_dgd ++;
};return _dgd ;};