//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package document ;import (_e "encoding/binary";_a "fmt";_dc "github.com/unidoc/unipdf/v3/common";_ef "github.com/unidoc/unipdf/v3/internal/bitwise";_de "github.com/unidoc/unipdf/v3/internal/jbig2/basic";_aa "github.com/unidoc/unipdf/v3/internal/jbig2/bitmap";_f "github.com/unidoc/unipdf/v3/internal/jbig2/document/segments";_bg "github.com/unidoc/unipdf/v3/internal/jbig2/encoder/classer";_ab "github.com/unidoc/unipdf/v3/internal/jbig2/errors";_g "io";_bb "math";_d "runtime/debug";);func (_fbc *Document )encodeEOFHeader (_aaac _ef .BinaryWriter )(_fadd int ,_dfg error ){_bfbf :=&_f .Header {SegmentNumber :_fbc .nextSegmentNumber (),Type :_f .TEndOfFile };if _fadd ,_dfg =_bfbf .Encode (_aaac );_dfg !=nil {return 0,_ab .Wrap (_dfg ,"\u0065n\u0063o\u0064\u0065\u0045\u004f\u0046\u0048\u0065\u0061\u0064\u0065\u0072","");};return _fadd ,nil ;};func (_cde *Page )Encode (w _ef .BinaryWriter )(_aga int ,_bege error ){const _geeb ="P\u0061\u0067\u0065\u002e\u0045\u006e\u0063\u006f\u0064\u0065";var _cdf int ;for _ ,_aeb :=range _cde .Segments {if _cdf ,_bege =_aeb .Encode (w );_bege !=nil {return _aga ,_ab .Wrap (_bege ,_geeb ,"");};_aga +=_cdf ;};return _aga ,nil ;};func _acc (_dda int )int {_bc :=0;_bd :=(_dda &(_dda -1))==0;_dda >>=1;for ;_dda !=0;_dda >>=1{_bc ++;};if _bd {return _bc ;};return _bc +1;};func DecodeDocument (input _ef .StreamReader ,globals *Globals )(*Document ,error ){return _ca (input ,globals );};func (_abd *Page )addTextRegionSegment (_bab []*_f .Header ,_fgc ,_fbcg map[int ]int ,_gfb []int ,_cga *_aa .Points ,_eca *_aa .Bitmaps ,_fdd *_de .IntSlice ,_bdfa *_aa .Boxes ,_dbf ,_gbgf int ){_gaff :=&_f .TextRegion {NumberOfSymbols :uint32 (_gbgf )};_gaff .InitEncode (_fgc ,_fbcg ,_gfb ,_cga ,_eca ,_fdd ,_bdfa ,_abd .FinalWidth ,_abd .FinalHeight ,_dbf );_fcdf :=&_f .Header {RTSegments :_bab ,SegmentData :_gaff ,PageAssociation :_abd .PageNumber ,Type :_f .TImmediateTextRegion };_edb :=_f .TPageInformation ;if _fbcg !=nil {_edb =_f .TSymbolDictionary ;};var _bfbfc int ;for ;_bfbfc < len (_abd .Segments );_bfbfc ++{if _abd .Segments [_bfbfc ].Type ==_edb {_bfbfc ++;break ;};};_abd .Segments =append (_abd .Segments ,nil );copy (_abd .Segments [_bfbfc +1:],_abd .Segments [_bfbfc :]);_abd .Segments [_bfbfc ]=_fcdf ;};func (_cbfd *Page )getResolutionY ()(int ,error ){const _debg ="\u0067\u0065\u0074\u0052\u0065\u0073\u006f\u006c\u0075t\u0069\u006f\u006e\u0059";if _cbfd .ResolutionY !=0{return _cbfd .ResolutionY ,nil ;};_bbe :=_cbfd .getPageInformationSegment ();if _bbe ==nil {return 0,_ab .Error (_debg ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_gdf ,_eed :=_bbe .GetSegmentData ();if _eed !=nil {return 0,_ab .Wrap (_eed ,_debg ,"");};_bdea ,_bgbf :=_gdf .(*_f .PageInformationSegment );if !_bgbf {return 0,_ab .Errorf (_debg ,"\u0070\u0061\u0067\u0065\u0020\u0069\u006e\u0066o\u0072\u006d\u0061ti\u006f\u006e\u0020\u0073\u0065\u0067m\u0065\u006e\u0074\u0020\u0069\u0073\u0020\u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006ci\u0064\u0020\u0074\u0079\u0070\u0065\u003a\u0027%\u0054\u0027",_gdf );};_cbfd .ResolutionY =_bdea .ResolutionY ;return _cbfd .ResolutionY ,nil ;};func (_bbb *Page )AddPageInformationSegment (){_ebba :=&_f .PageInformationSegment {PageBMWidth :_bbb .FinalWidth ,PageBMHeight :_bbb .FinalHeight ,ResolutionX :_bbb .ResolutionX ,ResolutionY :_bbb .ResolutionY ,IsLossless :_bbb .IsLossless };_dad :=&_f .Header {PageAssociation :_bbb .PageNumber ,SegmentDataLength :uint64 (_ebba .Size ()),SegmentData :_ebba ,Type :_f .TPageInformation };_bbb .Segments =append (_bbb .Segments ,_dad );};func (_aafgd *Page )composePageBitmap ()error {const _dgec ="\u0063\u006f\u006d\u0070\u006f\u0073\u0065\u0050\u0061\u0067\u0065\u0042i\u0074\u006d\u0061\u0070";if _aafgd .PageNumber ==0{return nil ;};_ebda :=_aafgd .getPageInformationSegment ();if _ebda ==nil {return _ab .Error (_dgec ,"\u0070\u0061\u0067e \u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069o\u006e \u0073e\u0067m\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064");};_aag ,_gcg :=_ebda .GetSegmentData ();if _gcg !=nil {return _gcg ;};_aeae ,_ged :=_aag .(*_f .PageInformationSegment );if !_ged {return _ab .Error (_dgec ,"\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006da\u0074\u0069\u006f\u006e \u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073\u0020\u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070\u0065");};if _gcg =_aafgd .createPage (_aeae );_gcg !=nil {return _ab .Wrap (_gcg ,_dgec ,"");};_aafgd .clearSegmentData ();return nil ;};func (_abfb *Globals )GetSegmentByIndex (index int )(*_f .Header ,error ){const _aadg ="\u0047l\u006f\u0062\u0061\u006cs\u002e\u0047\u0065\u0074\u0053e\u0067m\u0065n\u0074\u0042\u0079\u0049\u006e\u0064\u0065x";if _abfb ==nil {return nil ,_ab .Error (_aadg ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_abfb .Segments )==0{return nil ,_ab .Error (_aadg ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");};if index > len (_abfb .Segments )-1{return nil ,_ab .Error (_aadg ,"\u0069n\u0064e\u0078\u0020\u006f\u0075\u0074 \u006f\u0066 \u0072\u0061\u006e\u0067\u0065");};return _abfb .Segments [index ],nil ;};func (_gcf *Document )encodeSegment (_dce *_f .Header ,_fcgc *int )error {const _cg ="\u0065\u006e\u0063\u006f\u0064\u0065\u0053\u0065\u0067\u006d\u0065\u006e\u0074";_dce .SegmentNumber =_gcf .nextSegmentNumber ();_fae ,_bca :=_dce .Encode (_gcf ._daa );if _bca !=nil {return _ab .Wrapf (_bca ,_cg ,"\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u003a\u0020\u0027\u0025\u0064\u0027",_dce .SegmentNumber );};*_fcgc +=_fae ;return nil ;};func (_cdb *Page )GetResolutionX ()(int ,error ){return _cdb .getResolutionX ()};func (_fbfb *Document )GetPage (pageNumber int )(_f .Pager ,error ){const _aadf ="\u0044\u006fc\u0075\u006d\u0065n\u0074\u002e\u0047\u0065\u0074\u0050\u0061\u0067\u0065";if pageNumber < 0{_dc .Log .Debug ("\u004a\u0042\u0049\u00472\u0020\u0050\u0061\u0067\u0065\u0020\u002d\u0020\u0047e\u0074\u0050\u0061\u0067\u0065\u003a\u0020\u0025\u0064\u002e\u0020\u0050\u0061\u0067\u0065\u0020\u0063\u0061n\u006e\u006f\u0074\u0020\u0062e\u0020\u006c\u006f\u0077\u0065\u0072\u0020\u0074\u0068\u0061\u006e\u0020\u0030\u002e\u0020\u0025\u0073",pageNumber ,_d .Stack ());return nil ,_ab .Errorf (_aadf ,"\u0069\u006e\u0076\u0061l\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032\u0020d\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u0020\u002d\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064 \u0069\u006e\u0076\u0061\u006ci\u0064\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u003a\u0020\u0025\u0064",pageNumber );};if pageNumber > len (_fbfb .Pages ){_dc .Log .Debug ("\u0050\u0061\u0067\u0065 n\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u003a\u0020\u0025\u0064\u002e\u0020%\u0073",pageNumber ,_d .Stack ());return nil ,_ab .Error (_aadf ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065n\u0074\u0020\u002d\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");};_cfd ,_gadf :=_fbfb .Pages [pageNumber ];if !_gadf {_dc .Log .Debug ("\u0050\u0061\u0067\u0065 n\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u003a\u0020\u0025\u0064\u002e\u0020%\u0073",pageNumber ,_d .Stack ());return nil ,_ab .Errorf (_aadf ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065n\u0074\u0020\u002d\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");};return _cfd ,nil ;};func (_eeb *Globals )GetSegment (segmentNumber int )(*_f .Header ,error ){const _egcf ="\u0047l\u006fb\u0061\u006c\u0073\u002e\u0047e\u0074\u0053e\u0067\u006d\u0065\u006e\u0074";if _eeb ==nil {return nil ,_ab .Error (_egcf ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_eeb .Segments )==0{return nil ,_ab .Error (_egcf ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");};var _aafg *_f .Header ;for _ ,_aafg =range _eeb .Segments {if _aafg .SegmentNumber ==uint32 (segmentNumber ){break ;};};if _aafg ==nil {return nil ,_ab .Error (_egcf ,"\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");};return _aafg ,nil ;};func (_cae *Globals )GetSymbolDictionary ()(*_f .Header ,error ){const _aea ="G\u006c\u006f\u0062\u0061\u006c\u0073.\u0047\u0065\u0074\u0053\u0079\u006d\u0062\u006f\u006cD\u0069\u0063\u0074i\u006fn\u0061\u0072\u0079";if _cae ==nil {return nil ,_ab .Error (_aea ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_cae .Segments )==0{return nil ,_ab .Error (_aea ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");};for _ ,_gee :=range _cae .Segments {if _gee .Type ==_f .TSymbolDictionary {return _gee ,nil ;};};return nil ,_ab .Error (_aea ,"\u0067\u006c\u006fba\u006c\u0020\u0073\u0079\u006d\u0062\u006f\u006c\u0020d\u0069c\u0074i\u006fn\u0061\u0072\u0079\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064");};func _acf (_dec *Document ,_ede int )*Page {return &Page {Document :_dec ,PageNumber :_ede ,Segments :[]*_f .Header {}};};func (_bba *Document )GetGlobalSegment (i int )(*_f .Header ,error ){_gdd ,_ec :=_bba .GlobalSegments .GetSegment (i );if _ec !=nil {return nil ,_ab .Wrap (_ec ,"\u0047\u0065t\u0047\u006c\u006fb\u0061\u006c\u0053\u0065\u0067\u006d\u0065\u006e\u0074","");};return _gdd ,nil ;};func (_fec *Document )encodeFileHeader (_ead _ef .BinaryWriter )(_eaa int ,_ebd error ){const _eff ="\u0065\u006ec\u006f\u0064\u0065F\u0069\u006c\u0065\u0048\u0065\u0061\u0064\u0065\u0072";_eaa ,_ebd =_ead .Write (_da );if _ebd !=nil {return _eaa ,_ab .Wrap (_ebd ,_eff ,"\u0069\u0064");};if _ebd =_ead .WriteByte (0x01);_ebd !=nil {return _eaa ,_ab .Wrap (_ebd ,_eff ,"\u0066\u006c\u0061g\u0073");};_eaa ++;_cbf :=make ([]byte ,4);_e .BigEndian .PutUint32 (_cbf ,_fec .NumberOfPages );_bec ,_ebd :=_ead .Write (_cbf );if _ebd !=nil {return _bec ,_ab .Wrap (_ebd ,_eff ,"p\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072");};_eaa +=_bec ;return _eaa ,nil ;};type Document struct{Pages map[int ]*Page ;NumberOfPagesUnknown bool ;NumberOfPages uint32 ;GBUseExtTemplate bool ;InputStream _ef .StreamReader ;GlobalSegments *Globals ;OrganizationType _f .OrganizationType ;Classer *_bg .Classer ;XRes ,YRes int ;FullHeaders bool ;CurrentSegmentNumber uint32 ;AverageTemplates *_aa .Bitmaps ;BaseIndexes []int ;Refinement bool ;RefineLevel int ;_gg uint8 ;_daa *_ef .BufferedWriter ;EncodeGlobals bool ;_dcd int ;_c map[int ][]int ;_bgb map[int ][]int ;_bga []int ;_gb map[int ]int ;};func (_cgf *Page )String ()string {return _a .Sprintf ("\u0050\u0061\u0067\u0065\u0020\u0023\u0025\u0064",_cgf .PageNumber );};type Page struct{Segments []*_f .Header ;PageNumber int ;Bitmap *_aa .Bitmap ;FinalHeight int ;FinalWidth int ;ResolutionX int ;ResolutionY int ;IsLossless bool ;Document *Document ;FirstSegmentNumber int ;EncodingMethod EncodingMethod ;};func (_adbf *Page )getResolutionX ()(int ,error ){const _baf ="\u0067\u0065\u0074\u0052\u0065\u0073\u006f\u006c\u0075t\u0069\u006f\u006e\u0058";if _adbf .ResolutionX !=0{return _adbf .ResolutionX ,nil ;};_dcf :=_adbf .getPageInformationSegment ();if _dcf ==nil {return 0,_ab .Error (_baf ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_egf ,_eaee :=_dcf .GetSegmentData ();if _eaee !=nil {return 0,_ab .Wrap (_eaee ,_baf ,"");};_adfa ,_bdc :=_egf .(*_f .PageInformationSegment );if !_bdc {return 0,_ab .Errorf (_baf ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_egf );};_adbf .ResolutionX =_adfa .ResolutionX ;return _adbf .ResolutionX ,nil ;};func (_ccgd *Page )AddEndOfPageSegment (){_fgd :=&_f .Header {Type :_f .TEndOfPage ,PageAssociation :_ccgd .PageNumber };_ccgd .Segments =append (_ccgd .Segments ,_fgd );};func (_deb *Page )getWidth ()(int ,error ){const _dgb ="\u0067\u0065\u0074\u0057\u0069\u0064\u0074\u0068";if _deb .FinalWidth !=0{return _deb .FinalWidth ,nil ;};_fedb :=_deb .getPageInformationSegment ();if _fedb ==nil {return 0,_ab .Error (_dgb ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_ecac ,_gccb :=_fedb .GetSegmentData ();if _gccb !=nil {return 0,_ab .Wrap (_gccb ,_dgb ,"");};_fbe ,_bced :=_ecac .(*_f .PageInformationSegment );if !_bced {return 0,_ab .Errorf (_dgb ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_ecac );};_deb .FinalWidth =_fbe .PageBMWidth ;return _deb .FinalWidth ,nil ;};func (_ed *Document )completeClassifiedPages ()(_fea error ){const _fg ="\u0063\u006f\u006dpl\u0065\u0074\u0065\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0050\u0061\u0067\u0065\u0073";if _ed .Classer ==nil {return nil ;};_ed ._bga =make ([]int ,_ed .Classer .UndilatedTemplates .Size ());for _fcc :=0;_fcc < _ed .Classer .ClassIDs .Size ();_fcc ++{_aaf ,_ga :=_ed .Classer .ClassIDs .Get (_fcc );if _ga !=nil {return _ab .Wrapf (_ga ,_fg ,"\u0063\u006c\u0061\u0073s \u0077\u0069\u0074\u0068\u0020\u0069\u0064\u003a\u0020\u0027\u0025\u0064\u0027",_fcc );};_ed ._bga [_aaf ]++;};var _gge []int ;for _efd :=0;_efd < _ed .Classer .UndilatedTemplates .Size ();_efd ++{if _ed .NumberOfPages ==1||_ed ._bga [_efd ]> 1{_gge =append (_gge ,_efd );};};var (_gad *Page ;_ea bool ;);for _gbg ,_df :=range *_ed .Classer .ComponentPageNumbers {if _gad ,_ea =_ed .Pages [_df ];!_ea {return _ab .Errorf (_fg ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_gbg );};if _gad .EncodingMethod ==GenericEM {_dc .Log .Error ("\u0047\u0065\u006e\u0065\u0072\u0069c\u0020\u0070\u0061g\u0065\u0020\u0077i\u0074\u0068\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u003a \u0027\u0025\u0064\u0027\u0020ma\u0070\u0070\u0065\u0064\u0020\u0061\u0073\u0020\u0063\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0020\u0070\u0061\u0067\u0065",_gbg );continue ;};_ed ._bgb [_df ]=append (_ed ._bgb [_df ],_gbg );_ad ,_gd :=_ed .Classer .ClassIDs .Get (_gbg );if _gd !=nil {return _ab .Wrapf (_gd ,_fg ,"\u006e\u006f\u0020\u0073uc\u0068\u0020\u0063\u006c\u0061\u0073\u0073\u0049\u0044\u003a\u0020\u0025\u0064",_gbg );};if _ed ._bga [_ad ]==1&&_ed .NumberOfPages !=1{_db :=append (_ed ._c [_df ],_ad );_ed ._c [_df ]=_db ;};};if _fea =_ed .Classer .ComputeLLCorners ();_fea !=nil {return _ab .Wrap (_fea ,_fg ,"");};if _ ,_fea =_ed .addSymbolDictionary (0,_ed .Classer .UndilatedTemplates ,_gge ,_ed ._gb ,false );_fea !=nil {return _ab .Wrap (_fea ,_fg ,"");};return nil ;};type EncodingMethod int ;func (_ddd *Page )countRegions ()int {var _deca int ;for _ ,_gbd :=range _ddd .Segments {switch _gbd .Type {case 6,7,22,23,38,39,42,43:_deca ++;};};return _deca ;};func (_dgeb *Page )GetHeight ()(int ,error ){return _dgeb .getHeight ()};func (_cbcc *Page )getPageInformationSegment ()*_f .Header {for _ ,_gcb :=range _cbcc .Segments {if _gcb .Type ==_f .TPageInformation {return _gcb ;};};_dc .Log .Debug ("\u0050\u0061\u0067\u0065\u0020\u0069\u006e\u0066o\u0072\u006d\u0061ti\u006f\u006e\u0020\u0073\u0065\u0067m\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0066o\u0072\u0020\u0070\u0061\u0067\u0065\u003a\u0020%\u0073\u002e",_cbcc );return nil ;};func (_fc *Document )AddGenericPage (bm *_aa .Bitmap ,duplicateLineRemoval bool )(_aaa error ){const _gc ="\u0044\u006f\u0063um\u0065\u006e\u0074\u002e\u0041\u0064\u0064\u0047\u0065\u006e\u0065\u0072\u0069\u0063\u0050\u0061\u0067\u0065";if !_fc .FullHeaders &&_fc .NumberOfPages !=0{return _ab .Error (_gc ,"\u0064\u006f\u0063\u0075\u006de\u006e\u0074\u0020\u0061\u006c\u0072\u0065a\u0064\u0079\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0073\u0020\u0070\u0061\u0067\u0065\u002e\u0020\u0046\u0069\u006c\u0065\u004d\u006f\u0064\u0065\u0020\u0064\u0069\u0073\u0061\u006c\u006c\u006f\u0077\u0073\u0020\u0061\u0064\u0064i\u006e\u0067\u0020\u006d\u006f\u0072\u0065\u0020\u0074\u0068\u0061\u006e \u006f\u006e\u0065\u0020\u0070\u0061g\u0065");};_fe :=&Page {Segments :[]*_f .Header {},Bitmap :bm ,Document :_fc ,FinalHeight :bm .Height ,FinalWidth :bm .Width ,IsLossless :true };_fe .PageNumber =int (_fc .nextPageNumber ());_fc .Pages [_fe .PageNumber ]=_fe ;_fe .AddPageInformationSegment ();if _aaa =_fe .AddGenericRegion (bm ,0,0,0,_f .TImmediateGenericRegion ,duplicateLineRemoval );_aaa !=nil {return _ab .Wrap (_aaa ,_gc ,"");};if _fc .FullHeaders {_fe .AddEndOfPageSegment ();};return nil ;};func (_bdf *Document )isFileHeaderPresent ()(bool ,error ){_bdf .InputStream .Mark ();for _ ,_ecf :=range _da {_bfd ,_ebfd :=_bdf .InputStream .ReadByte ();if _ebfd !=nil {return false ,_ebfd ;};if _ecf !=_bfd {_bdf .InputStream .Reset ();return false ,nil ;};};_bdf .InputStream .Reset ();return true ,nil ;};func (_ddb *Document )parseFileHeader ()error {const _beg ="\u0070a\u0072s\u0065\u0046\u0069\u006c\u0065\u0048\u0065\u0061\u0064\u0065\u0072";_ ,_ffd :=_ddb .InputStream .Seek (8,_g .SeekStart );if _ffd !=nil {return _ab .Wrap (_ffd ,_beg ,"\u0069\u0064");};_ ,_ffd =_ddb .InputStream .ReadBits (5);if _ffd !=nil {return _ab .Wrap (_ffd ,_beg ,"\u0072\u0065\u0073\u0065\u0072\u0076\u0065\u0064\u0020\u0062\u0069\u0074\u0073");};_ce ,_ffd :=_ddb .InputStream .ReadBit ();if _ffd !=nil {return _ab .Wrap (_ffd ,_beg ,"\u0065x\u0074e\u006e\u0064\u0065\u0064\u0020t\u0065\u006dp\u006c\u0061\u0074\u0065\u0073");};if _ce ==1{_ddb .GBUseExtTemplate =true ;};_ce ,_ffd =_ddb .InputStream .ReadBit ();if _ffd !=nil {return _ab .Wrap (_ffd ,_beg ,"\u0075\u006e\u006b\u006eow\u006e\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072");};if _ce !=1{_ddb .NumberOfPagesUnknown =false ;};_ce ,_ffd =_ddb .InputStream .ReadBit ();if _ffd !=nil {return _ab .Wrap (_ffd ,_beg ,"\u006f\u0072\u0067\u0061\u006e\u0069\u007a\u0061\u0074\u0069\u006f\u006e \u0074\u0079\u0070\u0065");};_ddb .OrganizationType =_f .OrganizationType (_ce );if !_ddb .NumberOfPagesUnknown {_ddb .NumberOfPages ,_ffd =_ddb .InputStream .ReadUint32 ();if _ffd !=nil {return _ab .Wrap (_ffd ,_beg ,"\u006eu\u006db\u0065\u0072\u0020\u006f\u0066\u0020\u0070\u0061\u0067\u0065\u0073");};_ddb ._gg =13;};return nil ;};var _da =[]byte {0x97,0x4A,0x42,0x32,0x0D,0x0A,0x1A,0x0A};const (GenericEM EncodingMethod =iota ;CorrelationEM ;RankHausEM ;);func (_be *Document )GetNumberOfPages ()(uint32 ,error ){if _be .NumberOfPagesUnknown ||_be .NumberOfPages ==0{if len (_be .Pages )==0{if _bbc :=_be .mapData ();_bbc !=nil {return 0,_ab .Wrap (_bbc ,"\u0044o\u0063\u0075\u006d\u0065n\u0074\u002e\u0047\u0065\u0074N\u0075m\u0062e\u0072\u004f\u0066\u0050\u0061\u0067\u0065s","");};};return uint32 (len (_be .Pages )),nil ;};return _be .NumberOfPages ,nil ;};func (_fecf *Page )getCombinationOperator (_bfa *_f .PageInformationSegment ,_geec _aa .CombinationOperator )_aa .CombinationOperator {if _bfa .CombinationOperatorOverrideAllowed (){return _geec ;};return _bfa .CombinationOperator ();};func (_fbd *Document )determineRandomDataOffsets (_ada []*_f .Header ,_efee uint64 ){if _fbd .OrganizationType !=_f .ORandom {return ;};for _ ,_fde :=range _ada {_fde .SegmentDataStartOffset =_efee ;_efee +=_fde .SegmentDataLength ;};};func (_edf *Page )GetResolutionY ()(int ,error ){return _edf .getResolutionY ()};func (_eebc *Page )clearSegmentData (){for _fdbf :=range _eebc .Segments {_eebc .Segments [_fdbf ].CleanSegmentData ();};};func (_ccc *Page )fitsPage (_dde *_f .PageInformationSegment ,_feda *_aa .Bitmap )bool {return _ccc .countRegions ()==1&&_dde .DefaultPixelValue ()==0&&_dde .PageBMWidth ==_feda .Width &&_dde .PageBMHeight ==_feda .Height ;};func (_ae *Document )Encode ()(_fgg []byte ,_cbc error ){const _gae ="\u0044o\u0063u\u006d\u0065\u006e\u0074\u002e\u0045\u006e\u0063\u006f\u0064\u0065";var _eb ,_cce int ;if _ae .FullHeaders {if _eb ,_cbc =_ae .encodeFileHeader (_ae ._daa );_cbc !=nil {return nil ,_ab .Wrap (_cbc ,_gae ,"");};};var (_dbe bool ;_fcg *_f .Header ;_edd *Page ;);if _cbc =_ae .completeClassifiedPages ();_cbc !=nil {return nil ,_ab .Wrap (_cbc ,_gae ,"");};if _cbc =_ae .produceClassifiedPages ();_cbc !=nil {return nil ,_ab .Wrap (_cbc ,_gae ,"");};if _ae .GlobalSegments !=nil {for _ ,_fcg =range _ae .GlobalSegments .Segments {if _cbc =_ae .encodeSegment (_fcg ,&_eb );_cbc !=nil {return nil ,_ab .Wrap (_cbc ,_gae ,"");};};};for _ebe :=1;_ebe <=int (_ae .NumberOfPages );_ebe ++{if _edd ,_dbe =_ae .Pages [_ebe ];!_dbe {return nil ,_ab .Errorf (_gae ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_ebe );};for _ ,_fcg =range _edd .Segments {if _cbc =_ae .encodeSegment (_fcg ,&_eb );_cbc !=nil {return nil ,_ab .Wrap (_cbc ,_gae ,"");};};};if _ae .FullHeaders {if _cce ,_cbc =_ae .encodeEOFHeader (_ae ._daa );_cbc !=nil {return nil ,_ab .Wrap (_cbc ,_gae ,"");};_eb +=_cce ;};_fgg =_ae ._daa .Data ();if len (_fgg )!=_eb {_dc .Log .Debug ("\u0042\u0079\u0074\u0065\u0073 \u0077\u0072\u0069\u0074\u0074\u0065\u006e \u0028\u006e\u0029\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0074\u006f\u0020\u0074\u0068\u0065\u0020\u006c\u0065\u006e\u0067\u0074\u0068\u0020\u006f\u0066\u0020t\u0068\u0065\u0020\u0064\u0061\u0074\u0061\u0020\u0065\u006e\u0063\u006fd\u0065\u0064\u003a\u0020\u0027\u0025d\u0027",_eb ,len (_fgg ));};return _fgg ,nil ;};func (_age *Page )GetSegment (number int )(*_f .Header ,error ){const _aef ="\u0050a\u0067e\u002e\u0047\u0065\u0074\u0053\u0065\u0067\u006d\u0065\u006e\u0074";for _ ,_cgc :=range _age .Segments {if _cgc .SegmentNumber ==uint32 (number ){return _cgc ,nil ;};};_cac :=make ([]uint32 ,len (_age .Segments ));for _bed ,_bde :=range _age .Segments {_cac [_bed ]=_bde .SegmentNumber ;};return nil ,_ab .Errorf (_aef ,"\u0073e\u0067\u006d\u0065n\u0074\u0020\u0077i\u0074h \u006e\u0075\u006d\u0062\u0065\u0072\u003a \u0027\u0025\u0064\u0027\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0069\u006e\u0020\u0074\u0068\u0065\u0020\u0070\u0061\u0067\u0065\u003a\u0020'%\u0064'\u002e\u0020\u004b\u006e\u006f\u0077n\u0020\u0073\u0065\u0067\u006de\u006e\u0074\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u0073\u003a \u0025\u0076",number ,_age .PageNumber ,_cac );};func (_adb *Document )nextSegmentNumber ()uint32 {_eaf :=_adb .CurrentSegmentNumber ;_adb .CurrentSegmentNumber ++;return _eaf ;};type Globals struct{Segments []*_f .Header ;};func (_dg *Document )produceClassifiedPage (_abff *Page ,_af *_f .Header )(_afc error ){const _fcd ="p\u0072\u006f\u0064\u0075ce\u0043l\u0061\u0073\u0073\u0069\u0066i\u0065\u0064\u0050\u0061\u0067\u0065";var _gaf map[int ]int ;_fad :=_dg ._dcd ;_ac :=[]*_f .Header {_af };if len (_dg ._c [_abff .PageNumber ])> 0{_gaf =map[int ]int {};_aaee ,_cf :=_dg .addSymbolDictionary (_abff .PageNumber ,_dg .Classer .UndilatedTemplates ,_dg ._c [_abff .PageNumber ],_gaf ,false );if _cf !=nil {return _ab .Wrap (_cf ,_fcd ,"");};_ac =append (_ac ,_aaee );_fad +=len (_dg ._c [_abff .PageNumber ]);};_dd :=_dg ._bgb [_abff .PageNumber ];_dc .Log .Debug ("P\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020c\u006f\u006d\u0070\u0073: \u0025\u0076",_abff .PageNumber ,_dd );_abff .addTextRegionSegment (_ac ,_dg ._gb ,_gaf ,_dg ._bgb [_abff .PageNumber ],_dg .Classer .PtaLL ,_dg .Classer .UndilatedTemplates ,_dg .Classer .ClassIDs ,nil ,_acc (_fad ),len (_dg ._bgb [_abff .PageNumber ]));return nil ;};func (_bef *Document )mapData ()error {const _gda ="\u006da\u0070\u0044\u0061\u0074\u0061";var (_gdag []*_f .Header ;_fcgd int64 ;_ccf _f .Type ;);_bfee ,_ee :=_bef .isFileHeaderPresent ();if _ee !=nil {return _ab .Wrap (_ee ,_gda ,"");};if _bfee {if _ee =_bef .parseFileHeader ();_ee !=nil {return _ab .Wrap (_ee ,_gda ,"");};_fcgd +=int64 (_bef ._gg );_bef .FullHeaders =true ;};var (_eade *Page ;_egd bool ;);for _ccf !=51&&!_egd {_ccg ,_ff :=_f .NewHeader (_bef ,_bef .InputStream ,_fcgd ,_bef .OrganizationType );if _ff !=nil {return _ab .Wrap (_ff ,_gda ,"");};_dc .Log .Trace ("\u0044\u0065c\u006f\u0064\u0069\u006eg\u0020\u0073e\u0067\u006d\u0065\u006e\u0074\u0020\u006e\u0075m\u0062\u0065\u0072\u003a\u0020\u0025\u0064\u002c\u0020\u0054\u0079\u0070e\u003a\u0020\u0025\u0073",_ccg .SegmentNumber ,_ccg .Type );_ccf =_ccg .Type ;if _ccf !=_f .TEndOfFile {if _ccg .PageAssociation !=0{_eade =_bef .Pages [_ccg .PageAssociation ];if _eade ==nil {_eade =_acf (_bef ,_ccg .PageAssociation );_bef .Pages [_ccg .PageAssociation ]=_eade ;if _bef .NumberOfPagesUnknown {_bef .NumberOfPages ++;};};_eade .Segments =append (_eade .Segments ,_ccg );}else {_bef .GlobalSegments .AddSegment (_ccg );};};_gdag =append (_gdag ,_ccg );_fcgd =_bef .InputStream .StreamPosition ();if _bef .OrganizationType ==_f .OSequential {_fcgd +=int64 (_ccg .SegmentDataLength );};_egd ,_ff =_bef .reachedEOF (_fcgd );if _ff !=nil {_dc .Log .Debug ("\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u0020\u0072\u0065\u0061\u0063h\u0065\u0064\u0020\u0045\u004f\u0046\u0020\u0077\u0069\u0074\u0068\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0076",_ff );return _ab .Wrap (_ff ,_gda ,"");};};_bef .determineRandomDataOffsets (_gdag ,uint64 (_fcgd ));return nil ;};func (_dfa *Page )getHeight ()(int ,error ){const _eebg ="\u0067e\u0074\u0048\u0065\u0069\u0067\u0068t";if _dfa .FinalHeight !=0{return _dfa .FinalHeight ,nil ;};_dag :=_dfa .getPageInformationSegment ();if _dag ==nil {return 0,_ab .Error (_eebg ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_dgf ,_faf :=_dag .GetSegmentData ();if _faf !=nil {return 0,_ab .Wrap (_faf ,_eebg ,"");};_fgb ,_faa :=_dgf .(*_f .PageInformationSegment );if !_faa {return 0,_ab .Errorf (_eebg ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_dgf );};if _fgb .PageBMHeight ==_bb .MaxInt32 {_ ,_faf =_dfa .GetBitmap ();if _faf !=nil {return 0,_ab .Wrap (_faf ,_eebg ,"");};}else {_dfa .FinalHeight =_fgb .PageBMHeight ;};return _dfa .FinalHeight ,nil ;};func (_dgd *Page )createStripedPage (_gdgg *_f .PageInformationSegment )error {const _efeea ="\u0063\u0072\u0065\u0061\u0074\u0065\u0053\u0074\u0072\u0069\u0070\u0065d\u0050\u0061\u0067\u0065";_bcc ,_fegf :=_dgd .collectPageStripes ();if _fegf !=nil {return _ab .Wrap (_fegf ,_efeea ,"");};var _fef int ;for _ ,_fade :=range _bcc {if _cgad ,_bcg :=_fade .(*_f .EndOfStripe );_bcg {_fef =_cgad .LineNumber ()+1;}else {_cgd :=_fade .(_f .Regioner );_afd :=_cgd .GetRegionInfo ();_cea :=_dgd .getCombinationOperator (_gdgg ,_afd .CombinaionOperator );_dbb ,_gcgb :=_cgd .GetRegionBitmap ();if _gcgb !=nil {return _ab .Wrap (_gcgb ,_efeea ,"");};_gcgb =_aa .Blit (_dbb ,_dgd .Bitmap ,int (_afd .XLocation ),_fef ,_cea );if _gcgb !=nil {return _ab .Wrap (_gcgb ,_efeea ,"");};};};return nil ;};func (_cfc *Page )GetBitmap ()(_dge *_aa .Bitmap ,_gba error ){_dc .Log .Trace (_a .Sprintf ("\u005b\u0050\u0041G\u0045\u005d\u005b\u0023%\u0064\u005d\u0020\u0047\u0065\u0074\u0042i\u0074\u006d\u0061\u0070\u0020\u0062\u0065\u0067\u0069\u006e\u0073\u002e\u002e\u002e",_cfc .PageNumber ));defer func (){if _gba !=nil {_dc .Log .Trace (_a .Sprintf ("\u005b\u0050\u0041\u0047\u0045\u005d\u005b\u0023\u0025\u0064\u005d\u0020\u0047\u0065\u0074B\u0069t\u006d\u0061\u0070\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u002e\u0020\u0025\u0076",_cfc .PageNumber ,_gba ));}else {_dc .Log .Trace (_a .Sprintf ("\u005b\u0050\u0041\u0047\u0045\u005d\u005b\u0023\u0025\u0064]\u0020\u0047\u0065\u0074\u0042\u0069\u0074m\u0061\u0070\u0020\u0066\u0069\u006e\u0069\u0073\u0068\u0065\u0064",_cfc .PageNumber ));};}();if _cfc .Bitmap !=nil {return _cfc .Bitmap ,nil ;};_gba =_cfc .composePageBitmap ();if _gba !=nil {return nil ,_gba ;};return _cfc .Bitmap ,nil ;};func (_ebb *Document )nextPageNumber ()uint32 {_ebb .NumberOfPages ++;return _ebb .NumberOfPages };func (_fed *Page )AddGenericRegion (bm *_aa .Bitmap ,xloc ,yloc ,template int ,tp _f .Type ,duplicateLineRemoval bool )error {const _gag ="P\u0061\u0067\u0065\u002eAd\u0064G\u0065\u006e\u0065\u0072\u0069c\u0052\u0065\u0067\u0069\u006f\u006e";_faddb :=&_f .GenericRegion {};if _gdc :=_faddb .InitEncode (bm ,xloc ,yloc ,template ,duplicateLineRemoval );_gdc !=nil {return _ab .Wrap (_gdc ,_gag ,"");};_edae :=&_f .Header {Type :_f .TImmediateGenericRegion ,PageAssociation :_fed .PageNumber ,SegmentData :_faddb };_fed .Segments =append (_fed .Segments ,_edae );return nil ;};func (_fcag *Page )collectPageStripes ()(_fdc []_f .Segmenter ,_ecb error ){const _fdeg ="\u0063o\u006cl\u0065\u0063\u0074\u0050\u0061g\u0065\u0053t\u0072\u0069\u0070\u0065\u0073";var _edea _f .Segmenter ;for _ ,_adaa :=range _fcag .Segments {switch _adaa .Type {case 6,7,22,23,38,39,42,43:_edea ,_ecb =_adaa .GetSegmentData ();if _ecb !=nil {return nil ,_ab .Wrap (_ecb ,_fdeg ,"");};_fdc =append (_fdc ,_edea );case 50:_edea ,_ecb =_adaa .GetSegmentData ();if _ecb !=nil {return nil ,_ecb ;};_acd ,_ecc :=_edea .(*_f .EndOfStripe );if !_ecc {return nil ,_ab .Errorf (_fdeg ,"\u0045\u006e\u0064\u004f\u0066\u0053\u0074\u0072\u0069\u0070\u0065\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u006f\u0066\u0020\u0076\u0061l\u0069\u0064\u0020\u0074\u0079p\u0065\u003a \u0027\u0025\u0054\u0027",_edea );};_fdc =append (_fdc ,_acd );_fcag .FinalHeight =_acd .LineNumber ();};};return _fdc ,nil ;};func (_fba *Page )lastSegmentNumber ()(_fdff uint32 ,_defde error ){const _agad ="\u006c\u0061\u0073\u0074\u0053\u0065\u0067\u006d\u0065\u006e\u0074\u004eu\u006d\u0062\u0065\u0072";if len (_fba .Segments )==0{return _fdff ,_ab .Errorf (_agad ,"\u006e\u006f\u0020se\u0067\u006d\u0065\u006e\u0074\u0073\u0020\u0066\u006fu\u006ed\u0020i\u006e \u0074\u0068\u0065\u0020\u0070\u0061\u0067\u0065\u0020\u0027\u0025\u0064\u0027",_fba .PageNumber );};return _fba .Segments [len (_fba .Segments )-1].SegmentNumber ,nil ;};func (_bcf *Document )addSymbolDictionary (_fbb int ,_gf *_aa .Bitmaps ,_ag []int ,_efeg map[int ]int ,_bgba bool )(*_f .Header ,error ){const _def ="\u0061\u0064\u0064\u0053ym\u0062\u006f\u006c\u0044\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079";_eab :=&_f .SymbolDictionary {};if _bf :=_eab .InitEncode (_gf ,_ag ,_efeg ,_bgba );_bf !=nil {return nil ,_bf ;};_cd :=&_f .Header {Type :_f .TSymbolDictionary ,PageAssociation :_fbb ,SegmentData :_eab };if _fbb ==0{if _bcf .GlobalSegments ==nil {_bcf .GlobalSegments =&Globals {};};_bcf .GlobalSegments .AddSegment (_cd );return _cd ,nil ;};_adf ,_aad :=_bcf .Pages [_fbb ];if !_aad {return nil ,_ab .Errorf (_def ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_fbb );};var (_ge int ;_fcdb *_f .Header ;);for _ge ,_fcdb =range _adf .Segments {if _fcdb .Type ==_f .TPageInformation {break ;};};_ge ++;_adf .Segments =append (_adf .Segments ,nil );copy (_adf .Segments [_ge +1:],_adf .Segments [_ge :]);_adf .Segments [_ge ]=_cd ;return _cd ,nil ;};func (_gbc *Page )GetWidth ()(int ,error ){return _gbc .getWidth ()};func (_gab *Page )createPage (_gaeb *_f .PageInformationSegment )error {var _cfg error ;if !_gaeb .IsStripe ||_gaeb .PageBMHeight !=-1{_cfg =_gab .createNormalPage (_gaeb );}else {_cfg =_gab .createStripedPage (_gaeb );};return _cfg ;};func (_fca *Document )produceClassifiedPages ()(_efe error ){const _fa ="\u0070\u0072\u006f\u0064uc\u0065\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0050\u0061\u0067e\u0073";if _fca .Classer ==nil {return nil ;};var (_eg *Page ;_cb bool ;_fb *_f .Header ;);for _efg :=1;_efg <=int (_fca .NumberOfPages );_efg ++{if _eg ,_cb =_fca .Pages [_efg ];!_cb {return _ab .Errorf (_fa ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_efg );};if _eg .EncodingMethod ==GenericEM {continue ;};if _fb ==nil {if _fb ,_efe =_fca .GlobalSegments .GetSymbolDictionary ();_efe !=nil {return _ab .Wrap (_efe ,_fa ,"");};};if _efe =_fca .produceClassifiedPage (_eg ,_fb );_efe !=nil {return _ab .Wrapf (_efe ,_fa ,"\u0070\u0061\u0067\u0065\u003a\u0020\u0027\u0025\u0064\u0027",_efg );};};return nil ;};func (_dgebd *Page )nextSegmentNumber ()uint32 {return _dgebd .Document .nextSegmentNumber ()};func (_gdg *Document )reachedEOF (_cec int64 )(bool ,error ){const _gcc ="\u0072\u0065\u0061\u0063\u0068\u0065\u0064\u0045\u004f\u0046";_ ,_eae :=_gdg .InputStream .Seek (_cec ,_g .SeekStart );if _eae !=nil {_dc .Log .Debug ("\u0072\u0065\u0061c\u0068\u0065\u0064\u0045\u004f\u0046\u0020\u002d\u0020\u0064\u002e\u0049\u006e\u0070\u0075\u0074\u0053\u0074\u0072\u0065\u0061\u006d\u002e\u0053\u0065\u0065\u006b\u0020\u0066a\u0069\u006c\u0065\u0064\u003a\u0020\u0025\u0076",_eae );return false ,_ab .Wrap (_eae ,_gcc ,"\u0069n\u0070\u0075\u0074\u0020\u0073\u0074\u0072\u0065\u0061\u006d\u0020s\u0065\u0065\u006b\u0020\u0066\u0061\u0069\u006c\u0065\u0064");};_ ,_eae =_gdg .InputStream .ReadBits (32);if _eae ==_g .EOF {return true ,nil ;}else if _eae !=nil {return false ,_ab .Wrap (_eae ,_gcc ,"");};return false ,nil ;};func (_fdf *Document )completeSymbols ()(_bfe error ){const _dbg ="\u0063o\u006dp\u006c\u0065\u0074\u0065\u0053\u0079\u006d\u0062\u006f\u006c\u0073";if _fdf .Classer ==nil {return nil ;};if _fdf .Classer .UndilatedTemplates ==nil {return _ab .Error (_dbg ,"\u006e\u006f t\u0065\u006d\u0070l\u0061\u0074\u0065\u0073 de\u0066in\u0065\u0064\u0020\u0066\u006f\u0072\u0020th\u0065\u0020\u0063\u006c\u0061\u0073\u0073e\u0072");};_gfd :=len (_fdf .Pages )==1;_bgg :=make ([]int ,_fdf .Classer .UndilatedTemplates .Size ());var _bcfd int ;for _fbf :=0;_fbf < _fdf .Classer .ClassIDs .Size ();_fbf ++{_bcfd ,_bfe =_fdf .Classer .ClassIDs .Get (_fbf );if _bfe !=nil {return _ab .Wrap (_bfe ,_dbg ,"\u0063\u006c\u0061\u0073\u0073\u0020\u0049\u0044\u0027\u0073");};_bgg [_bcfd ]++;};var _bbf []int ;for _afb :=0;_afb < _fdf .Classer .UndilatedTemplates .Size ();_afb ++{if _bgg [_afb ]==0{return _ab .Error (_dbg ,"\u006eo\u0020\u0073y\u006d\u0062\u006f\u006cs\u0020\u0069\u006es\u0074\u0061\u006e\u0063\u0065\u0073\u0020\u0066\u006fun\u0064\u0020\u0066o\u0072\u0020g\u0069\u0076\u0065\u006e\u0020\u0063l\u0061\u0073s\u003f\u0020");};if _bgg [_afb ]> 1||_gfd {_bbf =append (_bbf ,_afb );};};_fdf ._dcd =len (_bbf );var _efegd ,_bfb int ;for _fdg :=0;_fdg < _fdf .Classer .ComponentPageNumbers .Size ();_fdg ++{_efegd ,_bfe =_fdf .Classer .ComponentPageNumbers .Get (_fdg );if _bfe !=nil {return _ab .Wrapf (_bfe ,_dbg ,"p\u0061\u0067\u0065\u003a\u0020\u0027\u0025\u0064\u0027 \u006e\u006f\u0074\u0020\u0066\u006f\u0075nd\u0020\u0069\u006e\u0020t\u0068\u0065\u0020\u0063\u006c\u0061\u0073\u0073\u0065r \u0070\u0061g\u0065\u006e\u0075\u006d\u0062\u0065\u0072\u0073",_fdg );};_bfb ,_bfe =_fdf .Classer .ClassIDs .Get (_fdg );if _bfe !=nil {return _ab .Wrapf (_bfe ,_dbg ,"\u0063\u0061\u006e\u0027\u0074\u0020\u0067e\u0074\u0020\u0073y\u006d\u0062\u006f\u006c \u0066\u006f\u0072\u0020\u0070\u0061\u0067\u0065\u0020\u0027\u0025\u0064\u0027\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u006c\u0061\u0073\u0073\u0065\u0072",_efegd );};if _bgg [_bfb ]==1&&!_gfd {_fdf ._c [_efegd ]=append (_fdf ._c [_efegd ],_bfb );};};if _bfe =_fdf .Classer .ComputeLLCorners ();_bfe !=nil {return _ab .Wrap (_bfe ,_dbg ,"");};return nil ;};func _ca (_fge _ef .StreamReader ,_aed *Globals )(*Document ,error ){_fdb :=&Document {Pages :make (map[int ]*Page ),InputStream :_fge ,OrganizationType :_f .OSequential ,NumberOfPagesUnknown :true ,GlobalSegments :_aed ,_gg :9};if _fdb .GlobalSegments ==nil {_fdb .GlobalSegments =&Globals {};};if _ffb :=_fdb .mapData ();_ffb !=nil {return nil ,_ffb ;};return _fdb ,nil ;};func (_cc *Document )AddClassifiedPage (bm *_aa .Bitmap ,method _bg .Method )(_fd error ){const _ba ="\u0044\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u002e\u0041\u0064d\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064P\u0061\u0067\u0065";if !_cc .FullHeaders &&_cc .NumberOfPages !=0{return _ab .Error (_ba ,"\u0064\u006f\u0063\u0075\u006de\u006e\u0074\u0020\u0061\u006c\u0072\u0065a\u0064\u0079\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0073\u0020\u0070\u0061\u0067\u0065\u002e\u0020\u0046\u0069\u006c\u0065\u004d\u006f\u0064\u0065\u0020\u0064\u0069\u0073\u0061\u006c\u006c\u006f\u0077\u0073\u0020\u0061\u0064\u0064i\u006e\u0067\u0020\u006d\u006f\u0072\u0065\u0020\u0074\u0068\u0061\u006e \u006f\u006e\u0065\u0020\u0070\u0061g\u0065");};if _cc .Classer ==nil {if _cc .Classer ,_fd =_bg .Init (_bg .DefaultSettings ());_fd !=nil {return _ab .Wrap (_fd ,_ba ,"");};};_abf :=int (_cc .nextPageNumber ());_aae :=&Page {Segments :[]*_f .Header {},Bitmap :bm ,Document :_cc ,FinalHeight :bm .Height ,FinalWidth :bm .Width ,PageNumber :_abf };_cc .Pages [_abf ]=_aae ;switch method {case _bg .RankHaus :_aae .EncodingMethod =RankHausEM ;case _bg .Correlation :_aae .EncodingMethod =CorrelationEM ;};_aae .AddPageInformationSegment ();if _fd =_cc .Classer .AddPage (bm ,_abf ,method );_fd !=nil {return _ab .Wrap (_fd ,_ba ,"");};if _cc .FullHeaders {_aae .AddEndOfPageSegment ();};return nil ;};func InitEncodeDocument (fullHeaders bool )*Document {return &Document {FullHeaders :fullHeaders ,_daa :_ef .BufferedMSB (),Pages :map[int ]*Page {},_c :map[int ][]int {},_gb :map[int ]int {},_bgb :map[int ][]int {}};};func (_bdd *Globals )AddSegment (segment *_f .Header ){_bdd .Segments =append (_bdd .Segments ,segment )};func (_bce *Page )createNormalPage (_eebf *_f .PageInformationSegment )error {const _bbcb ="\u0063\u0072e\u0061\u0074\u0065N\u006f\u0072\u006d\u0061\u006c\u0050\u0061\u0067\u0065";_bce .Bitmap =_aa .New (_eebf .PageBMWidth ,_eebf .PageBMHeight );if _eebf .DefaultPixelValue ()!=0{_bce .Bitmap .SetDefaultPixel ();};for _ ,_cab :=range _bce .Segments {switch _cab .Type {case 6,7,22,23,38,39,42,43:_dc .Log .Trace ("\u0047\u0065\u0074\u0074in\u0067\u0020\u0053\u0065\u0067\u006d\u0065\u006e\u0074\u003a\u0020\u0025\u0064",_cab .SegmentNumber );_bedf ,_fbfbf :=_cab .GetSegmentData ();if _fbfbf !=nil {return _fbfbf ;};_feg ,_bdde :=_bedf .(_f .Regioner );if !_bdde {_dc .Log .Debug ("\u0053\u0065g\u006d\u0065\u006e\u0074\u003a\u0020\u0025\u0054\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0061\u0020\u0052\u0065\u0067\u0069on\u0065\u0072",_bedf );return _ab .Errorf (_bbcb ,"i\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062i\u0067\u0032\u0020\u0073\u0065\u0067\u006den\u0074\u0020\u0074\u0079p\u0065\u0020\u002d\u0020\u006e\u006f\u0074\u0020\u0061 R\u0065\u0067i\u006f\u006e\u0065\u0072\u003a\u0020\u0025\u0054",_bedf );};_deg ,_fbfbf :=_feg .GetRegionBitmap ();if _fbfbf !=nil {return _ab .Wrap (_fbfbf ,_bbcb ,"");};if _bce .fitsPage (_eebf ,_deg ){_bce .Bitmap =_deg ;}else {_dege :=_feg .GetRegionInfo ();_fccg :=_bce .getCombinationOperator (_eebf ,_dege .CombinaionOperator );_fbfbf =_aa .Blit (_deg ,_bce .Bitmap ,int (_dege .XLocation ),int (_dege .YLocation ),_fccg );if _fbfbf !=nil {return _ab .Wrap (_fbfbf ,_bbcb ,"");};};};};return nil ;};